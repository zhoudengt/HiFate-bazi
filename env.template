# HiFate-bazi 环境变量配置模板
# 复制此文件为 .env 并修改相应的配置值
# 命令：cp env.template .env

# ============================================
# MySQL 数据库配置
# ⚠️ 重要：根据环境选择不同的配置
# 本地开发环境：应设置为 localhost:3306，密码: 123456
# 生产环境：应设置为 8.210.52.217:3306 (公网) 或 172.18.121.222:3306 (内网)，密码: Yuanqizhan@163
# ============================================
MYSQL_HOST=8.210.52.217  # 本地开发应设置为 localhost，生产环境使用 8.210.52.217 或 172.18.121.222
MYSQL_PORT=3306
MYSQL_USER=root
MYSQL_ROOT_PASSWORD=Yuanqizhan@163  # 本地开发应设置为 123456，生产环境使用 Yuanqizhan@163
MYSQL_PASSWORD=Yuanqizhan@163  # 本地开发应设置为 123456，生产环境使用 Yuanqizhan@163
MYSQL_DATABASE=hifate_bazi  # 数据库名

# ============================================
# Redis 缓存配置
# ============================================
REDIS_PASSWORD=your_redis_password_here

# ============================================
# 应用配置
# ============================================
APP_ENV=production
DEBUG=False
SECRET_KEY=your_secret_key_here_change_me
WEB_PORT=8001

# ============================================
# 时区配置
# ============================================
TZ=Asia/Shanghai

# ============================================
# gRPC 微服务地址（Docker 内部使用服务名）
# ============================================
BAZI_CORE_SERVICE_URL=bazi-core:9001
BAZI_FORTUNE_SERVICE_URL=bazi-fortune:9002
BAZI_ANALYZER_SERVICE_URL=bazi-analyzer:50051
BAZI_RULE_SERVICE_URL=rule-service:50053
FORTUNE_ANALYSIS_SERVICE_URL=fortune-analyzer:50052
FORTUNE_RULE_SERVICE_URL=fortune-rule:9007
PAYMENT_SERVICE_URL=payment-service:9006
INTENT_SERVICE_URL=intent-service:9008
PROMPT_OPTIMIZER_SERVICE_URL=prompt-optimizer:9009

# ============================================
# Coze API 配置（可选）
# ============================================
COZE_ACCESS_TOKEN=your_coze_access_token
COZE_BOT_ID=your_coze_bot_id
INTENT_BOT_ID=your_intent_bot_id
FORTUNE_ANALYSIS_BOT_ID=your_fortune_analysis_bot_id
DAILY_FORTUNE_ACTION_BOT_ID=your_daily_fortune_action_bot_id
XISHEN_JISHEN_BOT_ID=your_xishen_jishen_bot_id  # 喜神忌神AI分析专用（可选，未设置时使用 COZE_BOT_ID）
MARRIAGE_ANALYSIS_BOT_ID=7587253915310096384  # 八字命理-感情婚姻分析专用（可选，未设置时使用 COZE_BOT_ID）
GENERAL_REVIEW_BOT_ID=your_general_review_bot_id  # 八字命理-总评分析专用（可选，未设置时使用 COZE_BOT_ID）

# ============================================
# Prompt 版本管理（可选）
# ============================================
PROMPT_VERSION=v1.0
PROMPT_CACHE_TTL=3600

# ============================================
# Stripe 支付配置（可选）
# ============================================
STRIPE_SECRET_KEY=your_stripe_secret_key
FRONTEND_BASE_URL=https://your-domain.com

# ============================================
# OAuth 2.0 认证配置
# ============================================
# OAuth 客户端凭证
OAUTH_CLIENT_ID=hifate_client
OAUTH_CLIENT_SECRET=hifate_secret_change_me

# Token 过期时间配置
OAUTH_AUTHORIZATION_CODE_EXPIRE_MINUTES=10  # 授权码过期时间（分钟）
OAUTH_ACCESS_TOKEN_EXPIRE_MINUTES=60  # Access Token 过期时间（分钟）
OAUTH_REFRESH_TOKEN_EXPIRE_DAYS=30  # Refresh Token 过期时间（天）

# Redis 配置（认证服务使用）
REDIS_DB=0  # Redis 数据库编号（默认 0）

# ============================================
# 阿里云容器镜像服务 (ACR) 配置（推荐）
# ============================================
# 配置 ACR 后，部署时将自动从 ACR 拉取镜像，避免本地构建占用磁盘空间
# ACR_REGISTRY=registry.cn-hangzhou.aliyuncs.com
# ACR_NAMESPACE=your-namespace
# ACR_USERNAME=your-username
# ACR_PASSWORD=your-password
# IMAGE_TAG=master  # 镜像标签，默认为 master

# ============================================
# GitHub Container Registry (GHCR) 配置（备选）
# ============================================
# 如果未配置 ACR，可以配置 GHCR 作为备选
# GITHUB_TOKEN=your_github_token
# GITHUB_ACTOR=your_github_username

# ============================================
# MongoDB 数据库配置
# ⚠️ 重要：所有环境统一连接生产Node1 Docker MongoDB，确保数据一致性
# 生产Node1 Docker MongoDB: 8.210.52.217:27017 (公网，本地开发使用) / 172.18.121.222:27017 (内网，生产环境使用)
# ============================================
MONGO_HOST=8.210.52.217  # Node1 公网IP（本地开发使用），生产环境使用 172.18.121.222
MONGO_PORT=27017
MONGO_DB=bazi_feedback  # 生产数据库名
MONGO_USER=  # 如需要认证，配置用户名
MONGO_PASSWORD=  # 如需要认证，配置密码

# ============================================
# 注意事项
# ============================================
# 1. ⚠️ 数据库连接规范：
#    - 本地开发环境：连接本地MySQL（localhost:3306，密码123456）和本地MongoDB
#    - 生产环境：连接生产Node1 Docker MySQL（8.210.52.217:3306 或 172.18.121.222:3306，密码Yuanqizhan@163）和MongoDB
# 2. ⚠️ 代码开发流程：代码必须在本地开发，不能直接在生产服务器上修改
#    开发完成后提交到Git，然后通过增量部署到双机
# 3. SECRET_KEY 应该是一个随机生成的字符串
# 4. 保存此文件后，运行 chmod 600 .env 保护敏感信息
# 5. 推荐配置 ACR，避免本地构建占用磁盘空间

