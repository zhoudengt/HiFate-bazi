#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
旺衰配置加载器 - 使用内置配置数据
注意：不再从 Excel 读取，直接使用硬编码配置，确保部署一致性
"""

import logging
from typing import Dict, List

logger = logging.getLogger(__name__)


class WangShuaiConfigLoader:
    """旺衰配置加载器 - 使用内置配置数据"""
    
    def __init__(self, excel_path: str = None):
        """
        初始化配置加载器
        
        Args:
            excel_path: 已废弃参数，保留用于向后兼容
        """
        self.config = self._get_default_config()
        logger.info("✅ 旺衰配置加载完成（使用内置配置）")
    
    def _get_default_config(self) -> Dict:
        """获取默认硬编码配置（当Excel不可用时）"""
        logger.info("📝 使用硬编码默认配置")
        
        return {
            'month_branch': [
                {'日干': '甲', '月支1': '寅', '月支2': '卯', '月支3': '亥', '月支4': '子'},
                {'日干': '乙', '月支1': '寅', '月支2': '卯', '月支3': '亥', '月支4': '子'},
                {'日干': '丙', '月支1': '巳', '月支2': '午', '月支3': '寅', '月支4': '卯'},
                {'日干': '丁', '月支1': '巳', '月支2': '午', '月支3': '寅', '月支4': '卯'},
                {'日干': '戊', '月支1': '巳', '月支2': '午', '月支3': '辰', '月支4': '戌'},
                {'日干': '己', '月支1': '巳', '月支2': '午', '月支3': '辰', '月支4': '戌'},
                {'日干': '庚', '月支1': '申', '月支2': '酉', '月支3': '辰', '月支4': '戌'},
                {'日干': '辛', '月支1': '申', '月支2': '酉', '月支3': '辰', '月支4': '戌'},
                {'日干': '壬', '月支1': '亥', '月支2': '子', '月支3': '申', '月支4': '酉'},
                {'日干': '癸', '月支1': '亥', '月支2': '子', '月支3': '申', '月支4': '酉'},
            ],
            'de_di': [
                {'日干': '甲', '生得地五行': '水', '同得地五行': '木'},
                {'日干': '乙', '生得地五行': '水', '同得地五行': '木'},
                {'日干': '丙', '生得地五行': '木', '同得地五行': '火'},
                {'日干': '丁', '生得地五行': '木', '同得地五行': '火'},
                {'日干': '戊', '生得地五行': '火', '同得地五行': '土'},
                {'日干': '己', '生得地五行': '火', '同得地五行': '土'},
                {'日干': '庚', '生得地五行': '土', '同得地五行': '金'},
                {'日干': '辛', '生得地五行': '土', '同得地五行': '金'},
                {'日干': '壬', '生得地五行': '金', '同得地五行': '水'},
                {'日干': '癸', '生得地五行': '金', '同得地五行': '水'},
            ],
            'hidden_scores': [
                # 1个藏干：对应分值1 = 15
                {'藏干数量': 1, '第1个匹配': 15, '第1个不匹配': -15},
                # 2个藏干：对应分值1 = 10, 对应分值2 = 5
                {'藏干数量': 2, '第1个匹配': 10, '第1个不匹配': -10, '第2个匹配': 5, '第2个不匹配': -5},
                # 3个藏干：对应分值1 = 8, 对应分值2 = 4, 对应分值3 = 3
                {'藏干数量': 3, '第1个匹配': 8, '第1个不匹配': -8, '第2个匹配': 4, '第2个不匹配': -4, '第3个匹配': 3, '第3个不匹配': -3},
            ],
            'thresholds': [
                {'旺衰状态': '极旺', '最小分数': 80, '最大分数': 100},
                {'旺衰状态': '身旺', '最小分数': 50, '最大分数': 79},
                {'旺衰状态': '平衡', '最小分数': 40, '最大分数': 49},
                {'旺衰状态': '身弱', '最小分数': 20, '最大分数': 39},
                {'旺衰状态': '极弱', '最小分数': 0, '最大分数': 19},
            ],
            'xi_ji': [
                {'旺衰状态': '极旺', '喜神': '食神,伤官,偏财,正财,七杀,正官', '忌神': '比肩,劫财,偏印,正印'},
                {'旺衰状态': '身旺', '喜神': '食神,伤官,偏财,正财,七杀,正官', '忌神': '比肩,劫财,偏印,正印'},
                {'旺衰状态': '平衡', '喜神': '比肩,劫财,食神,伤官', '忌神': '偏财,正财,七杀,正官'},
                {'旺衰状态': '身弱', '喜神': '比肩,劫财,偏印,正印', '忌神': '食神,伤官,偏财,正财,七杀,正官'},
                {'旺衰状态': '极弱', '喜神': '比肩,劫财,偏印,正印', '忌神': '食神,伤官,偏财,正财,七杀,正官'},
            ],
            'ten_god_elements': [
                {'十神': '比肩', '五行': '木'},  # 根据实际天干确定
                {'十神': '劫财', '五行': '木'},
                {'十神': '食神', '五行': '火'},
                {'十神': '伤官', '五行': '火'},
                {'十神': '偏财', '五行': '土'},
                {'十神': '正财', '五行': '土'},
                {'十神': '七杀', '五行': '金'},
                {'十神': '正官', '五行': '金'},
                {'十神': '偏印', '五行': '水'},
                {'十神': '正印', '五行': '水'},
            ]
        }

