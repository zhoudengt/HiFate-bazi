# -*- coding: utf-8 -*-
"""
十神简称配置 - 用于大运流年流月显示
根据用户提供的十神关系对照表
"""

# 十神全称到简称的映射
SHISHEN_SHORT_MAP = {
    '正印': '印',
    '偏印': '枭',
    '正官': '官',
    '七杀': '杀',
    '正财': '才',
    '偏财': '财',
    '食神': '食',
    '伤官': '伤',
    '比肩': '比',
    '劫财': '劫',
}

# 天干十神映射表 - TIANGAN_SHISHEN_MAP[日主][目标天干] = 十神简称
# 根据用户提供的十神关系对照表
TIANGAN_SHISHEN_MAP = {
    '甲': {'甲': '比', '乙': '劫', '丙': '食', '丁': '伤', '戊': '财', '己': '才', '庚': '杀', '辛': '官', '壬': '枭', '癸': '印'},
    '乙': {'甲': '劫', '乙': '比', '丙': '伤', '丁': '食', '戊': '才', '己': '财', '庚': '官', '辛': '杀', '壬': '印', '癸': '枭'},
    '丙': {'甲': '枭', '乙': '印', '丙': '比', '丁': '劫', '戊': '食', '己': '伤', '庚': '财', '辛': '才', '壬': '杀', '癸': '官'},
    '丁': {'甲': '印', '乙': '枭', '丙': '劫', '丁': '比', '戊': '伤', '己': '食', '庚': '才', '辛': '财', '壬': '官', '癸': '杀'},
    '戊': {'甲': '杀', '乙': '官', '丙': '枭', '丁': '印', '戊': '比', '己': '劫', '庚': '食', '辛': '伤', '壬': '财', '癸': '才'},
    '己': {'甲': '官', '乙': '杀', '丙': '印', '丁': '枭', '戊': '劫', '己': '比', '庚': '伤', '辛': '食', '壬': '才', '癸': '财'},
    '庚': {'甲': '财', '乙': '才', '丙': '杀', '丁': '官', '戊': '枭', '己': '印', '庚': '比', '辛': '劫', '壬': '食', '癸': '伤'},
    '辛': {'甲': '才', '乙': '财', '丙': '官', '丁': '杀', '戊': '印', '己': '枭', '庚': '劫', '辛': '比', '壬': '伤', '癸': '食'},
    '壬': {'甲': '食', '乙': '伤', '丙': '财', '丁': '才', '戊': '杀', '己': '官', '庚': '枭', '辛': '印', '壬': '比', '癸': '劫'},
    '癸': {'甲': '伤', '乙': '食', '丙': '才', '丁': '财', '戊': '官', '己': '杀', '庚': '印', '辛': '枭', '壬': '劫', '癸': '比'},
}

# 地支十神映射表 - DIZHI_SHISHEN_MAP[日主][目标地支] = 十神简称
# 根据用户提供的十神关系对照表
DIZHI_SHISHEN_MAP = {
    '甲': {'子': '印', '丑': '官', '寅': '比', '卯': '劫', '辰': '印', '巳': '食', '午': '伤', '未': '劫', '申': '杀', '酉': '官', '戌': '伤', '亥': '枭'},
    '乙': {'子': '枭', '丑': '杀', '寅': '劫', '卯': '比', '辰': '印', '巳': '伤', '午': '食', '未': '比', '申': '官', '酉': '杀', '戌': '伤', '亥': '印'},
    '丙': {'子': '官', '丑': '才', '寅': '枭', '卯': '印', '辰': '官', '巳': '比', '午': '劫', '未': '印', '申': '财', '酉': '才', '戌': '劫', '亥': '杀'},
    '丁': {'子': '杀', '丑': '才', '寅': '印', '卯': '枭', '辰': '杀', '巳': '劫', '午': '比', '未': '印', '申': '才', '酉': '财', '戌': '比', '亥': '官'},
    '戊': {'子': '才', '丑': '伤', '寅': '杀', '卯': '官', '辰': '才', '巳': '枭', '午': '印', '未': '官', '申': '食', '酉': '伤', '戌': '印', '亥': '财'},
    '己': {'子': '财', '丑': '食', '寅': '官', '卯': '杀', '辰': '食', '巳': '印', '午': '枭', '未': '杀', '申': '伤', '酉': '食', '戌': '官', '亥': '才'},
    '庚': {'子': '伤', '丑': '劫', '寅': '财', '卯': '才', '辰': '劫', '巳': '杀', '午': '官', '未': '才', '申': '比', '酉': '劫', '戌': '杀', '亥': '食'},
    '辛': {'子': '食', '丑': '比', '寅': '才', '卯': '财', '辰': '比', '巳': '官', '午': '杀', '未': '才', '申': '劫', '酉': '比', '戌': '才', '亥': '伤'},
    '壬': {'子': '劫', '丑': '印', '寅': '食', '卯': '伤', '辰': '食', '巳': '财', '午': '才', '未': '伤', '申': '枭', '酉': '印', '戌': '才', '亥': '比'},
    '癸': {'子': '比', '丑': '印', '寅': '伤', '卯': '食', '辰': '劫', '巳': '才', '午': '财', '未': '食', '申': '印', '酉': '枭', '戌': '才', '亥': '劫'},
}

# 地支本气（主气）映射 - 用于计算地支的十神（备用方法）
# 每个地支的主气（第一个藏干）
BRANCH_MAIN_QI = {
    '子': '癸',  # 子：癸水（本气）
    '丑': '己',  # 丑：己土（本气）
    '寅': '甲',  # 寅：甲木（本气）
    '卯': '乙',  # 卯：乙木（本气）
    '辰': '戊',  # 辰：戊土（本气）
    '巳': '丙',  # 巳：丙火（本气）
    '午': '丁',  # 午：丁火（本气）
    '未': '己',  # 未：己土（本气）
    '申': '庚',  # 申：庚金（本气）
    '酉': '辛',  # 酉：辛金（本气）
    '戌': '戊',  # 戌：戊土（本气）
    '亥': '壬',  # 亥：壬水（本气）
}


def get_shishen_by_tiangan(day_stem: str, target_stem: str) -> str:
    """
    根据日主和目标天干获取十神简称
    
    Args:
        day_stem: 日主天干（甲乙丙丁戊己庚辛壬癸）
        target_stem: 目标天干
    
    Returns:
        十神简称（比劫食伤财才官杀印枭）
    """
    return TIANGAN_SHISHEN_MAP.get(day_stem, {}).get(target_stem, '')


def get_shishen_by_dizhi(day_stem: str, target_branch: str) -> str:
    """
    根据日主和目标地支获取十神简称
    
    Args:
        day_stem: 日主天干（甲乙丙丁戊己庚辛壬癸）
        target_branch: 目标地支
    
    Returns:
        十神简称（比劫食伤财才官杀印枭）
    """
    return DIZHI_SHISHEN_MAP.get(day_stem, {}).get(target_branch, '')
