# 基于图片神煞对照表的新配置 - 包含日支和日干两种对照表

# 神煞对照表 - 以日支为列，其他支为行

# 新增：以日支为基准查其他地支
DEITIES_LOOKUP_BY_DAY_BRANCH_TO_OTHERS = {
    '子': {
        'year': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'month': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'hour': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']}
    },
    '丑': {
        'year': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'month': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'hour': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']}
    },
    '寅': {
        'year': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']},
        'month': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']}
    },
    '卯': {
        'year': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []},
        'month': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []},
        'hour': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []}
    },
    '辰': {
        'year': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['地网','劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'month': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['地网','劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'hour': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['地网','劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']}
    },
    '巳': {
        'year': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': ['地网'], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'month': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': ['地网'], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'hour': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': ['地网'], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']}
    },
    '午': {
        'year': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']},
        'month': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['劫煞']}
    },
    '未': {
        'year': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []},
        'month': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []},
        'hour': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': [], '亥': []}
    },

    '申': {
        'year': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'month': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']},
        'hour': {'子': ['将星'], '丑': [], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['劫煞'], '午': [], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['亡神']}
    },
    '酉': {
        'year': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'month': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']},
        'hour': {'子': [], '丑': ['华盖'], '寅': ['劫煞'], '卯': [], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['亡神'], '酉': ['将星'], '戌': [], '亥': ['驿马']}
    },
    '戌': {
        'year': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['天罗','劫煞']},
        'month': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['天罗','劫煞']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['亡神'], '午': ['将星'], '未': [], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['天罗','劫煞']}
    },
    '亥': {
        'year': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': ['天罗'], '亥': []},
        'month': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': ['天罗'], '亥': []},
        'hour': {'子': ['桃花'], '丑': [], '寅': ['亡神'], '卯': ['将星'], '辰': [], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['劫煞'], '酉': [], '戌': ['天罗'], '亥': []}
    }
}


DEITIES_LOOKUP_BY_DAY_BRANCH = {
    # 1 第一部分：四柱神煞（基于地支组合）

    #新增

    '申子辰': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '寅午戌': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '巳酉丑': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '亥卯未': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    # 第二部分：孤辰寡宿
    #新增
    '亥子丑': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [''], '亥': []
    },

    '寅卯辰': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '巳午未': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '申酉戌': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [''], '申': [], '酉': [], '戌': [], '亥': []
    },

    # 第三部分：详细神煞（基于单个地支）
    #新增
    '子': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '丑': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '寅': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '卯': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '辰': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '巳': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '午': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '未': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '申': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '酉': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '戌': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '亥': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    }
}

#2  神煞对照表 - 以日干为列，其他支为行
DEITIES_LOOKUP_BY_DAY_STEM = {

     #新增
    '甲': {
        '子': ['太极贵人','福星贵人'], '丑': ['天乙贵人'], '寅': ['禄神','福星贵人'], '卯': ['羊刃'], '辰': ['金舆'], '巳': ['文昌贵人','天厨贵人'],
        '午': ['太极贵人','红艳煞'], '未': ['天乙贵人','天官贵人'], '申': [], '酉': ['流霞'], '戌': ['国印贵人','官印贵人'], '亥': []
    },

    '乙': {
        '子': ['天乙贵人','太极贵人'], '丑': ['福星贵人'], '寅': ['羊刃'], '卯': ['禄神','福星贵人'], '辰': ['天官贵人'], '巳': ['金舆'],
        '午': ['太极贵人','文昌贵人','红艳煞','天厨贵人'], '未': [], '申': ['天乙贵人'], '酉': [], '戌': ['流霞'], '亥': ['国印贵人','官印贵人']
    },

    '丙': {
        '子': ['福星贵人'], '丑': ['国印贵人','官印贵人'], '寅': ['红艳煞','福星贵人'], '卯': ['太极贵人'], '辰': ['天官贵人'], '巳': ['禄神','天厨贵人'],
        '午': ['羊刃'], '未': ['流霞','金舆'], '申': ['文昌贵人'], '酉': ['天乙贵人','太极贵人'], '戌': [], '亥': ['天乙贵人']
    },

    '丁': {
        '子': [], '丑': [], '寅': ['国印贵人','官印贵人'], '卯': ['太极贵人'], '辰': [], '巳': ['羊刃'],
        '午': ['禄神','天厨贵人'], '未': ['红艳煞'], '申': ['金舆'], '酉': ['天乙贵人','流霞','太极贵人','文昌贵人','天官贵人'], '戌': [], '亥': ['天乙贵人','福星贵人']
    },

    '戊': {
        '子': [], '丑': ['天乙贵人','太极贵人','国印贵人','官印贵人'], '寅': [], '卯': [], '辰': ['太极贵人','红艳煞'], '巳': ['禄神','流霞'],
        '午': ['羊刃'], '未': ['天乙贵人','太极贵人','金舆'], '申': ['文昌贵人','天厨贵人','福星贵人'], '酉': [], '戌': ['太极贵人','天官贵人'], '亥': []
    },

    '己': {
        '子': ['天乙贵人'], '丑': ['太极贵人'], '寅': ['国印贵人','官印贵人'], '卯': ['天官贵人'], '辰': ['太极贵人','红艳煞'], '巳': ['羊刃'],
        '午': ['禄神','流霞'], '未': ['天乙贵人','太极贵人','福星贵人'], '申': ['金舆'], '酉': ['文昌贵人','天厨贵人'], '戌': ['太极贵人'], '亥': []
    },

    '庚': {
        '子': [], '丑': ['天乙贵人','天官贵人'], '寅': ['太极贵人'], '卯': [], '辰': ['流霞','国印贵人','官印贵人'], '巳': [],
        '午': ['福星贵人'], '未': ['天乙贵人'], '申': ['禄神'], '酉': ['羊刃'], '戌': ['金舆','红艳煞'], '亥': ['太极贵人','文昌贵人','天厨贵人']
    },

    '辛': {
        '子': ['文昌贵人','天厨贵人'], '丑': [], '寅': ['天乙贵人','太极贵人'], '卯': ['流霞'], '辰': [], '巳': ['国印贵人','福星贵人','官印贵人'],
        '午': ['天乙贵人'], '未': [], '申': ['羊刃','天官贵人'], '酉': ['禄神','红艳煞'], '戌': [], '亥': ['太极贵人','金舆']
    },

    '壬': {
        '子': ['羊刃','红艳煞'], '丑': ['金舆'], '寅': ['文昌贵人','天厨贵人','天官贵人'], '卯': ['天乙贵人'], '辰': ['福星贵人'], '巳': ['天乙贵人','太极贵人'],
        '午': [], '未': ['国印贵人','官印贵人'], '申': ['太极贵人'], '酉': [], '戌': [], '亥': ['禄神','流霞']
    },

    '癸': {
        '子': ['禄神'], '丑': ['福星贵人'], '寅': ['流霞','金舆'], '卯': ['天乙贵人','文昌贵人','天厨贵人','福星贵人'], '辰': [], '巳': ['天乙贵人','太极贵人'],
        '午': ['天官贵人'], '未': [], '申': ['太极贵人','国印贵人','红艳煞','官印贵人'], '酉': [], '戌': [], '亥': ['羊刃']
    }
}

 ##年
DEITIES_LOOKUP_BY_YEAR_BRANCH_TO_OTHERS = {
    '子': {
        'day': {'子': ['将星','金匮贵人'], '丑': [], '寅': ['驿马','孤辰','丧门'], '卯': ['红鸾'], '辰': ['华盖'], '巳': ['劫煞'], '午': ['灾煞'], '未': [], '申': [], '酉': ['桃花','天喜','披麻'], '戌': ['寡宿','吊客'], '亥': ['亡神']},
        'month': {'子': ['将星','金匮贵人'], '丑': [], '寅': ['驿马','孤辰','丧门'], '卯': ['红鸾'], '辰': ['华盖'], '巳': ['劫煞'], '午': ['灾煞'], '未': [], '申': [], '酉': ['桃花','天喜','披麻'], '戌': ['寡宿''吊客'], '亥': ['亡神']},
        'hour': {'子': ['将星','金匮贵人'], '丑': [], '寅': ['驿马','孤辰','丧门'], '卯': ['红鸾'], '辰': ['华盖'], '巳': ['劫煞'], '午': ['灾煞'], '未': [], '申': [], '酉': ['桃花','天喜','披麻'], '戌': ['寡宿''吊客'], '亥': ['亡神']}
    },
    '丑': {
        'day': {'子': [], '丑': ['华盖'], '寅': ['孤辰','红鸾','劫煞'], '卯': ['丧门','灾煞'], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['天喜','亡神'], '酉': ['将星','金匮贵人'], '戌': ['寡宿','披麻'], '亥': ['驿马','吊客']},
        'month': {'子': [], '丑': ['华盖'], '寅': ['孤辰','红鸾','劫煞'], '卯': ['丧门','灾煞'], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['天喜','亡神'], '酉': ['将星','金匮贵人'], '戌': ['寡宿','披麻'], '亥': ['驿马','吊客']},
        'hour': {'子': [], '丑': ['华盖'], '寅': ['孤辰','红鸾','劫煞'], '卯': ['丧门','灾煞'], '辰': [], '巳': [], '午': ['桃花'], '未': [], '申': ['天喜','亡神'], '酉': ['将星','金匮贵人'], '戌': ['寡宿','披麻'], '亥': ['驿马','吊客']}
    },
    '寅': {
        'day': {'子': ['吊客','灾煞'], '丑': ['寡宿','红鸾'], '寅': [], '卯': ['桃花'], '辰': ['丧门'], '巳': ['孤辰','亡神'], '午': ['将星','金匮贵人'], '未': ['天喜'], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['披麻','劫煞']},
        'month': {'子': ['吊客','灾煞'], '丑': ['寡宿','红鸾'], '寅': [], '卯': ['桃花'], '辰': ['丧门'], '巳': ['孤辰','亡神'], '午': ['将星','金匮贵人'], '未': ['天喜'], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['披麻','劫煞']},
        'hour': {'子': ['吊客','灾煞'], '丑': ['寡宿','红鸾'], '寅': [], '卯': ['桃花'], '辰': ['丧门'], '巳': ['孤辰','亡神'], '午': ['将星','金匮贵人'], '未': ['天喜'], '申': ['驿马'], '酉': [], '戌': ['华盖'], '亥': ['披麻','劫煞']}
    },
    '卯': {
        'day': {'子': ['桃花','红鸾','披麻'], '丑': ['寡宿','吊客'], '寅': ['亡神'], '卯': ['将星','金匮贵人'], '辰': [], '巳': ['驿马','孤辰','丧门'], '午': ['天喜'], '未': ['华盖'], '申': ['劫煞'], '酉': ['灾煞'], '戌': [], '亥': []},
        'month': {'子': ['桃花','红鸾','披麻'], '丑': ['寡宿','吊客'], '寅': ['亡神'], '卯': ['将星','金匮贵人'], '辰': [], '巳': ['驿马','孤辰','丧门'], '午': ['天喜'], '未': ['华盖'], '申': ['劫煞'], '酉': ['灾煞'], '戌': [], '亥': []},
        'hour': {'子': ['桃花','红鸾','披麻'], '丑': ['寡宿','吊客'], '寅': ['亡神'], '卯': ['将星','金匮贵人'], '辰': [], '巳': ['驿马','孤辰','丧门'], '午': ['天喜'], '未': ['华盖'], '申': ['劫煞'], '酉': ['灾煞'], '戌': [], '亥': []}
    },
    '辰': {
        'day': {'子': ['将星','金匮贵人'], '丑': ['寡宿','披麻'], '寅': ['驿马','吊客'], '卯': [], '辰': ['华盖'], '巳': ['孤辰','地网','天喜','劫煞'], '午': ['丧门','灾煞'], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['红鸾','亡神']},
        'month': {'子': ['将星','金匮贵人'], '丑': ['寡宿','披麻'], '寅': ['驿马','吊客'], '卯': [], '辰': ['华盖'], '巳': ['孤辰','地网','天喜','劫煞'], '午': ['丧门','灾煞'], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['红鸾','亡神']},
        'hour': {'子': ['将星','金匮贵人'], '丑': ['寡宿','披麻'], '寅': ['驿马','吊客'], '卯': [], '辰': ['华盖'], '巳': ['孤辰','地网','天喜','劫煞'], '午': ['丧门','灾煞'], '未': [], '申': [], '酉': ['桃花'], '戌': [], '亥': ['红鸾','亡神']}
    },
    '巳': {
        'day': {'子': [], '丑': ['华盖'], '寅': ['披麻','劫煞'], '卯': ['吊客','灾煞'], '辰': ['寡宿','地网','天喜'], '巳': [], '午': ['桃花'], '未': ['丧门'], '申': ['孤辰','亡神'], '酉': ['将星','金匮贵人'], '戌': ['红鸾'], '亥': ['驿马']},
        'month': {'子': [], '丑': ['华盖'], '寅': ['披麻','劫煞'], '卯': ['吊客','灾煞'], '辰': ['寡宿','地网','天喜'], '巳': [], '午': ['桃花'], '未': ['丧门'], '申': ['孤辰','亡神'], '酉': ['将星','金匮贵人'], '戌': ['红鸾'], '亥': ['驿马']},
        'hour': {'子': [], '丑': ['华盖'], '寅': ['披麻','劫煞'], '卯': ['吊客','灾煞'], '辰': ['寡宿','地网','天喜'], '巳': [], '午': ['桃花'], '未': ['丧门'], '申': ['孤辰','亡神'], '酉': ['将星','金匮贵人'], '戌': ['红鸾'], '亥': ['驿马']}
    },
    '午': {
        'day': {'子': ['灾煞'], '丑': [], '寅': [], '卯': ['桃花','天喜','披麻'], '辰': ['寡宿','吊客'], '巳': ['亡神'], '午': ['将星','金匮贵人'], '未': [], '申': ['驿马','孤辰','丧门'], '酉': ['红鸾'], '戌': ['华盖'], '亥': ['劫煞']},
        'month': {'子': ['灾煞'], '丑': [], '寅': [], '卯': ['桃花','天喜','披麻'], '辰': ['寡宿','吊客'], '巳': ['亡神'], '午': ['将星','金匮贵人'], '未': [], '申': ['驿马','孤辰','丧门'], '酉': ['红鸾'], '戌': ['华盖'], '亥': ['劫煞']},
        'hour': {'子': ['灾煞'], '丑': [], '寅': [], '卯': ['桃花','天喜','披麻'], '辰': ['寡宿','吊客'], '巳': ['亡神'], '午': ['将星','金匮贵人'], '未': [], '申': ['驿马','孤辰','丧门'], '酉': ['红鸾'], '戌': ['华盖'], '亥': ['劫煞']}
    },
    '未': {
        'day': {'子': ['桃花'], '丑': [], '寅': ['天喜','亡神'], '卯': ['将星','金匮贵人'], '辰': ['寡宿','披麻'], '巳': ['驿马','吊客'], '午': [], '未': ['华盖'], '申': ['孤辰','红鸾','劫煞'], '酉': ['丧门','灾煞'], '戌': [], '亥': []},
        'month': {'子': ['桃花'], '丑': [], '寅': ['天喜','亡神'], '卯': ['将星','金匮贵人'], '辰': ['寡宿','披麻'], '巳': ['驿马','吊客'], '午': [], '未': ['华盖'], '申': ['孤辰','红鸾','劫煞'], '酉': ['丧门','灾煞'], '戌': [], '亥': []},
        'hour': {'子': ['桃花'], '丑': [], '寅': ['天喜','亡神'], '卯': ['将星','金匮贵人'], '辰': ['寡宿','披麻'], '巳': ['驿马','吊客'], '午': [], '未': ['华盖'], '申': ['孤辰','红鸾','劫煞'], '酉': ['丧门','灾煞'], '戌': [], '亥': []}
    },
    '申': {
        'day': {'子': ['将星','金匮贵人'], '丑': ['天喜'], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['披麻','劫煞'], '午': ['吊客','灾煞'], '未': ['寡宿','红鸾'], '申': [], '酉': ['桃花'], '戌': ['丧门'], '亥': ['孤辰','亡神']},
        'month': {'子': ['将星','金匮贵人'], '丑': ['天喜'], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['披麻','劫煞'], '午': ['吊客','灾煞'], '未': ['寡宿','红鸾'], '申': [], '酉': ['桃花'], '戌': ['丧门'], '亥': ['孤辰','亡神']},
        'hour': {'子': ['将星','金匮贵人'], '丑': ['天喜'], '寅': ['驿马'], '卯': [], '辰': ['华盖'], '巳': ['披麻','劫煞'], '午': ['吊客','灾煞'], '未': ['寡宿','红鸾'], '申': [], '酉': ['桃花'], '戌': ['丧门'], '亥': ['孤辰','亡神']}
    },
    '酉': {
        'day': {'子': ['天喜'], '丑': ['华盖'], '寅': ['劫煞'], '卯': ['灾煞'], '辰': [], '巳': [], '午': ['桃花','红鸾','披麻'], '未': ['寡宿','吊客'], '申': ['亡神'], '酉': ['将星','金匮贵人'], '戌': [], '亥': ['驿马','孤辰','丧门']},
        'month': {'子': ['天喜'], '丑': ['华盖'], '寅': ['劫煞'], '卯': ['灾煞'], '辰': [], '巳': [], '午': ['桃花','红鸾','披麻'], '未': ['寡宿','吊客'], '申': ['亡神'], '酉': ['将星','金匮贵人'], '戌': [], '亥': ['驿马','孤辰','丧门']},
        'hour': {'子': ['天喜'], '丑': ['华盖'], '寅': ['劫煞'], '卯': ['灾煞'], '辰': [], '巳': [], '午': ['桃花','红鸾','披麻'], '未': ['寡宿','吊客'], '申': ['亡神'], '酉': ['将星','金匮贵人'], '戌': [], '亥': ['驿马','孤辰','丧门']}
    },
    '戌': {
        'day': {'子': ['丧门','灾煞'], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['红鸾','亡神'], '午': ['将星','金匮贵人'], '未': ['寡宿','披麻'], '申': ['驿马','吊客'], '酉': [], '戌': ['华盖'], '亥': ['孤辰','天罗','天喜','劫煞']},
        'month': {'子': ['丧门','灾煞'], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['红鸾','亡神'], '午': ['将星','金匮贵人'], '未': ['寡宿','披麻'], '申': ['驿马','吊客'], '酉': [], '戌': ['华盖'], '亥': ['孤辰','天罗','天喜','劫煞']},
        'hour': {'子': ['丧门','灾煞'], '丑': [], '寅': [], '卯': ['桃花'], '辰': [], '巳': ['红鸾','亡神'], '午': ['将星','金匮贵人'], '未': ['寡宿','披麻'], '申': ['驿马','吊客'], '酉': [], '戌': ['华盖'], '亥': ['孤辰','天罗','天喜','劫煞']}
    },
    '亥': {
        'day': {'子': ['桃花'], '丑': ['丧门'], '寅': ['孤辰','亡神'], '卯': ['将星','金匮贵人'], '辰': ['红鸾'], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['披麻','劫煞'], '酉': ['吊客','灾煞'], '戌': ['寡宿','天罗','天喜'], '亥': []},
        'month': {'子': ['桃花'], '丑': ['丧门'], '寅': ['孤辰','亡神'], '卯': ['将星','金匮贵人'], '辰': ['红鸾'], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['披麻','劫煞'], '酉': ['吊客','灾煞'], '戌': ['寡宿','天罗','天喜'], '亥': []},
        'hour': {'子': ['桃花'], '丑': ['丧门'], '寅': ['孤辰','亡神'], '卯': ['将星','金匮贵人'], '辰': ['红鸾'], '巳': ['驿马'], '午': [], '未': ['华盖'], '申': ['披麻','劫煞'], '酉': ['吊客','灾煞'], '戌': ['寡宿','天罗','天喜'], '亥': []}
    }
}
# 新增神煞对照表配置 - 按照十二地支顺序补全
# 3. 以年干为列，其他支为行
DEITIES_LOOKUP_BY_YEAR_STEM = {
    #新增
    '甲': {
        '子': ['太极贵人','福星贵人'], '丑': ['天乙贵人'], '寅': ['福星贵人'], '卯': [], '辰': ['金舆'], '巳': ['文昌贵人','天厨贵人'],
        '午': ['太极贵人'], '未': ['天乙贵人','天官贵人'], '申': [], '酉': [], '戌': ['国印贵人','官印贵人'], '亥': []
    },

    '乙': {
        '子': ['天乙贵人','太极贵人'], '丑': ['福星贵人'], '寅': [], '卯': ['福星贵人'], '辰': ['天官贵人'], '巳': ['金舆'],
        '午': ['太极贵人','文昌贵人','天厨贵人'], '未': [], '申': ['天乙贵人'], '酉': [], '戌': [], '亥': ['国印贵人','官印贵人']
    },

    '丙': {
        '子': ['福星贵人'], '丑': ['国印贵人','官印贵人'], '寅': ['福星贵人'], '卯': ['太极贵人'], '辰': ['天官贵人'], '巳': ['天厨贵人'],
        '午': [], '未': ['金舆'], '申': ['文昌贵人'], '酉': ['天乙贵人','太极贵人'], '戌': [], '亥': ['天乙贵人']
    },

    '丁': {
        '子': [], '丑': [], '寅': ['国印贵人','官印贵人'], '卯': ['太极贵人'], '辰': [], '巳': [],
        '午': ['天厨贵人'], '未': [], '申': ['金舆'], '酉': ['天乙贵人','太极贵人','文昌贵人','天官贵人'], '戌': [], '亥': ['天乙贵人','福星贵人']
    },

    '戊': {
        '子': [], '丑': ['天乙贵人','太极贵人','国印贵人','官印贵人'], '寅': [], '卯': [], '辰': ['太极贵人'], '巳': [],
        '午': [], '未': ['天乙贵人','太极贵人','金舆'], '申': ['文昌贵人','天厨贵人','福星贵人'], '酉': [], '戌': ['太极贵人','天官贵人'], '亥': []
    },


    '己': {
        '子': ['天乙贵人'], '丑': ['太极贵人'], '寅': ['国印贵人','官印贵人'], '卯': ['天官贵人'], '辰': ['太极贵人'], '巳': [],
        '午': [], '未': ['天乙贵人','太极贵人','福星贵人'], '申': ['金舆'], '酉': ['文昌贵人','天厨贵人'], '戌': ['太极贵人'], '亥': []
    },

    '庚': {
        '子': [], '丑': ['天乙贵人','天官贵人'], '寅': ['太极贵人'], '卯': [], '辰': ['国印贵人','官印贵人'], '巳': [],
        '午': ['福星贵人'], '未': ['天乙贵人'], '申': [], '酉': [], '戌': ['金舆'], '亥': ['太极贵人','文昌贵人','天厨贵人']
    },

    '辛': {
        '子': ['文昌贵人','天厨贵人'], '丑': [], '寅': ['天乙贵人'], '卯': [], '辰': [], '巳': ['国印贵人','福星贵人','官印贵人'],
        '午': ['天乙贵人'], '未': [], '申': ['天官贵人'], '酉': [], '戌': [], '亥': ['太极贵人','金舆']
    },

    '壬': {
        '子': [], '丑': ['金舆'], '寅': ['文昌贵人','天厨贵人','天官贵人'], '卯': ['天乙贵人'], '辰': ['福星贵人'], '巳': ['天乙贵人','太极贵人'],
        '午': [], '未': ['国印贵人','官印贵人'], '申': ['太极贵人'], '酉': [], '戌': [], '亥': []
    },

    '癸': {
        '子': [], '丑': ['福星贵人'], '寅': ['太极贵人','金舆'], '卯': ['天乙贵人','文昌贵人','天厨贵人','福星贵人'], '辰': [], '巳': ['天乙贵人','太极贵人'],
        '午': ['天官贵人'], '未': [], '申': ['太极贵人','国印贵人','官印贵人'], '酉': [], '戌': [], '亥': []
    }
}

# 4. 以年支为列，其他支为行
DEITIES_LOOKUP_BY_YEAR_BRANCH = {

    ##增加
    '申子辰': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '寅午戌': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '巳酉丑': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '亥卯未': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },



    ##增加
    '亥子丑': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': ['寡宿'], '亥': []
    },

    '寅卯辰': {
        '子': [], '丑': ['寡宿'], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '巳午未': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': ['寡宿'], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },

    '申酉戌': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': ['寡宿'], '申': [], '酉': [], '戌': [], '亥': []
    },

    #新增
    '子': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '丑': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '寅': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '卯': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '辰': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '巳': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '午': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '未': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '申': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '酉': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '戌': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '亥': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
}


# 新增：以月支为基准查其他地支
DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_OTHERS = {
    '子': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['血刃'], '未': [], '申': [], '酉': [], '戌': [], '亥': ['天医']},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['血刃'], '未': [], '申': [], '酉': [], '戌': [], '亥': ['天医']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['血刃'], '未': [], '申': [], '酉': [], '戌': [], '亥': ['天医']}
    },
    '丑': {
        'year': {'子': ['血刃','天医'], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': ['血刃','天医'], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': ['血刃','天医'], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '寅': {
        'year': {'子': [], '丑': ['血刃','天医'], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': ['血刃','天医'], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': ['血刃','天医'], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '卯': {
        'year': {'子': [], '丑': [], '寅': ['天医'], '卯': [], '辰': [], '巳': [], '午': [], '未': ['血刃'], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': ['天医'], '卯': [], '辰': [], '巳': [], '午': [], '未': ['血刃'], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': ['天医'], '卯': [], '辰': [], '巳': [], '午': [], '未': ['血刃'], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '辰': {
        'year': {'子': [], '丑': [], '寅': ['血刃'], '卯': ['天医'], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': ['血刃'], '卯': ['天医'], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': ['血刃'], '卯': ['天医'], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '巳': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['天医'], '巳': [], '午': [], '未': [], '申': ['血刃'], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['天医'], '巳': [], '午': [], '未': [], '申': ['血刃'], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['天医'], '巳': [], '午': [], '未': [], '申': ['血刃'], '酉': [], '戌': [], '亥': []}
    },

    '午': {
        'year': {'子': [], '丑': [], '寅': [], '卯': ['血刃'], '辰': [], '巳': ['天医'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': ['血刃'], '辰': [], '巳': ['天医'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': ['血刃'], '辰': [], '巳': ['天医'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '未': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['天医'], '未': [], '申': [], '酉': ['血刃'], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['天医'], '未': [], '申': [], '酉': ['血刃'], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': ['天医'], '未': [], '申': [], '酉': ['血刃'], '戌': [], '亥': []}
    },
    '申': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['血刃'], '巳': [], '午': [], '未': ['天医'], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['血刃'], '巳': [], '午': [], '未': ['天医'], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': ['血刃'], '巳': [], '午': [], '未': ['天医'], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '酉': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['天医'], '酉': [], '戌': ['血刃'], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['天医'], '酉': [], '戌': ['血刃'], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['天医'], '酉': [], '戌': ['血刃'], '亥': []}
    },
    '戌': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['血刃'], '午': [], '未': [], '申': [], '酉': ['天医'], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['血刃'], '午': [], '未': [], '申': [], '酉': ['天医'], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['血刃'], '午': [], '未': [], '申': [], '酉': ['天医'], '戌': [], '亥': []}
    },
    '亥': {
        'year': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': ['天医'], '亥': ['血刃']},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': ['天医'], '亥': ['血刃']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': ['天医'], '亥': ['血刃']}
    }

}

# 5. 以月干为列，其他支为行
DEITIES_LOOKUP_BY_MONTH_STEM = {


    '甲': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '乙': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '丙': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '丁': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '戊': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '己': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '庚': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '辛': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '壬': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '癸': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
}

# 6. 以月支为列，其他支为行   童子煞 --  没有年支
DEITIES_LOOKUP_BY_MONTH_BRANCH = {



    ##增加
    '子': {'子': [], '丑': [], '寅': [], '卯': ['童子煞'], '辰': ['童子煞'], '巳': ['天德贵人'], '午': [], '未': ['童子煞'], '申': ['天德合'], '酉': [], '戌': [], '亥': []},
    '丑': {'子': ['天医'], '丑': [], '寅': [], '卯': ['童子煞'], '辰': ['童子煞'], '巳': [], '午': [], '未': ['童子煞'], '申': [], '酉': [], '戌': [], '亥': []},

    '寅': {'子': ['童子煞'], '丑': [], '寅': ['童子煞'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '卯': {'子': ['童子煞'], '丑': [], '寅': ['童子煞'], '卯': [], '辰': [], '巳': ['天德合'], '午': [], '未': [], '申': ['天德贵人'], '酉': [], '戌': [], '亥': []},
    '辰': {'子': ['童子煞'], '丑': [], '寅': ['童子煞'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},


    '巳': {'子': [], '丑': [], '寅': [], '卯': ['童子煞'], '辰': ['童子煞'], '巳': [], '午': [], '未': ['童子煞'], '申': [], '酉': [], '戌': [], '亥': []},
    '午': {'子': [], '丑': [], '寅': ['天德合'], '卯': ['童子煞'], '辰': ['童子煞'], '巳': [], '午': [], '未': ['童子煞'], '申': [], '酉': [], '戌': [], '亥': ['天德贵人']},
    '未': {'子': [], '丑': [], '寅': [], '卯': ['童子煞'], '辰': ['童子煞'], '巳': [], '午': [], '未': ['童子煞'], '申': [], '酉': [], '戌': [], '亥': []},


    '申': {'子': ['童子煞'], '丑': [], '寅': ['童子煞'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '酉': {'子': ['童子煞'], '丑': [], '寅': ['天德贵人','童子煞'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': ['天德合']},
    '戌': {'子': ['童子煞'], '丑': [], '寅': ['童子煞'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},


    '亥': {'子': [], '丑': [], '寅': [], '卯': ['童子煞'], '辰': ['童子煞'], '巳': [], '午': [], '未': ['童子煞'], '申': [], '酉': [], '戌': [], '亥': []}
}

# 7. 以月支为列，其他干支为行
DEITIES_LOOKUP_BY_MONTH_BRANCH_STEM = {

    ##增加
    # '申子辰': {
    #     '甲': [], '乙': [], '丙': [], '丁': ['月德合'], '戊': ['德秀贵人'], '己': ['德秀贵人'], '庚': [], '辛': [], '壬': ['月德贵人','德秀贵人'], '癸': ['德秀贵人']
    # },
    # '寅午戌': {
    #     '甲': [], '乙': [], '丙': ['月德贵人','德秀贵人'], '丁': ['德秀贵人'], '戊': ['德秀贵人'], '己': ['德秀贵人'], '庚': [], '辛': ['月德合'], '壬': [], '癸': []
    # },
    # '巳酉丑': {
    #     '甲': [], '乙': ['月德合','德秀贵人'], '丙': [], '丁': [], '戊': [], '己': [], '庚': ['月德贵人','德秀贵人'], '辛': ['德秀贵人'], '壬': [], '癸': []
    # },
    # '亥卯未': {
    #     '甲': ['月德贵人','德秀贵人'], '乙': ['德秀贵人'], '丙': [], '丁': ['德秀贵人'], '戊': [], '己': ['月德合'], '庚': [], '辛': [], '壬': ['德秀贵人'], '癸': []
    # },
    ##增加

    '子': {'甲': ['德秀贵人'], '乙': ['德秀贵人'], '丙': ['德秀贵人'], '丁': ['月德合'], '戊': ['德秀贵人'], '己': ['德秀贵人'], '庚': ['天德贵人'], '辛': ['德秀贵人'], '壬': ['月德','月德贵人','德秀贵人'], '癸': ['德秀贵人']},
    '丑': {'甲': [], '乙': ['天德合','月德合','德秀贵人'], '丙': [], '丁': [], '戊': [], '己': [], '庚': ['天德贵人','月德贵人','德秀贵人'], '辛': ['德秀贵人'], '壬': [], '癸': []},
    '寅': {'甲': [], '乙': [], '丙': ['月德贵人','德秀贵人'], '丁': ['天德贵人','德秀贵人'], '戊': ['天德','德秀贵人'], '己': [], '庚': [], '辛': ['月德合'], '壬': ['天德合'], '癸': ['德秀贵人']},
    '卯': {'甲': ['月德贵人','德秀贵人'], '乙': ['德秀贵人'], '丙': [], '丁': ['德秀贵人'], '戊': [], '己': ['月德合'], '庚': [], '辛': [], '壬': ['德秀贵人'], '癸': []},
    '辰': {'甲': ['德秀贵人'], '乙': ['德秀贵人'], '丙': ['德秀贵人'], '丁': ['天德合','月德合'], '戊': ['德秀贵人'], '己': ['德秀贵人'], '庚': [], '辛': ['德秀贵人'], '壬': ['天德贵人','月德贵人','德秀贵人'], '癸': ['德秀贵人']},
    '巳': {'甲': [], '乙': ['月德合','德秀贵人'], '丙': ['天德合'], '丁': [], '戊': [], '己': [], '庚': ['月德贵人','德秀贵人'], '辛': ['天德贵人','德秀贵人'], '壬': [], '癸': []},


    '午': {'甲': [], '乙': [], '丙': ['月德贵人','德秀贵人'], '丁': ['德秀贵人'], '戊': ['德秀贵人'], '己': [], '庚': [], '辛': ['月德合'], '壬': [], '癸': ['德秀贵人']},
    '未': {'甲': ['天德贵人','月德贵人','德秀贵人'], '乙': ['德秀贵人'], '丙': [], '丁': ['德秀贵人'], '戊': [], '己': ['天德合','月德合'], '庚': [], '辛': [], '壬': ['德秀贵人'], '癸': []},
    '申': {'甲': ['德秀贵人'], '乙': ['德秀贵人'], '丙': ['德秀贵人'], '丁': ['月德合'], '戊': ['天德合','德秀贵人'], '己': ['德秀贵人'], '庚': [], '辛': ['德秀贵人'], '壬': ['月德贵人','德秀贵人'], '癸': ['天德贵人','德秀贵人']},
    '酉': {'甲': [], '乙': ['月德合','德秀贵人'], '丙': [], '丁': [], '戊': [], '己': [], '庚': ['月德贵人','德秀贵人'], '辛': ['德秀贵人'], '壬': [], '癸': []},


    '戌': {'甲': [], '乙': [], '丙': ['天德贵人','月德贵人','德秀贵人'], '丁': ['德秀贵人'], '戊': ['德秀贵人'], '己': [], '庚': [], '辛': ['天德合','月德合'], '壬': [], '癸': ['德秀贵人']},
    '亥': {'甲': ['月德贵人','德秀贵人'], '乙': ['天德贵人','德秀贵人'], '丙': [], '丁': ['德秀贵人'], '戊': [], '己': ['月德合'], '庚': ['天德合'], '辛': [], '壬': ['德秀贵人'], '癸': []}

}

# 6. 以年纳音查日支
DEITIES_LOOKUP_BY_YEAR_NAYIN_DAY_BRANCH = {

    # 增加
    '金': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '木': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '水': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '火': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
    '土': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
}

# 7. 以月支查日柱
DEITIES_LOOKUP_BY_MONTH_BRANCH_DAY_PILLAR = {

    # 增加

    '子': {'辛卯': [],'丙戊': ['四废日'],'甲子': ['天赦日'],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': ['地转'], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['天转'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': ['四废日'], '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': [], '甲申': []},
    '丑': {'辛卯': [],'丙戊': ['四废日'],'甲子': ['天赦日'],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': ['地转'], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['天转'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': ['四废日'], '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': [], '甲申': []},



    '寅': {'辛卯': ['地转'],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': ['天赦日'], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': ['天赦日','乞丐贵人'], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': [], '乙卯': ['天转'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': ['四废日'], '辛酉': ['四废日'], '壬戌': [], '癸亥': [], '甲申': []},
    '卯': {'辛卯': ['地转'],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': ['天赦日'], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': ['天赦日'], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': ['乞丐贵人'], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': [], '乙卯': ['天转'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': ['四废日'], '辛酉': ['四废日'], '壬戌': [], '癸亥': [], '甲申': []},
    '辰': {'辛卯': ['地转'],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': ['天赦日'], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': ['天赦日'], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': ['乞丐贵人'], '乙卯': ['天转'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': ['四废日'], '辛酉': ['四废日'], '壬戌': [], '癸亥': [], '甲申': []},




    '巳': {'辛卯': [],'丙戊': [],'甲子': ['乞丐贵人'],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': ['天转'], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['四废日'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [], '戊午': ['地转'], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': ['四废日'], '甲申': []},
    '午': {'辛卯': [],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': ['天转'], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['四废日'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [], '戊午': ['地转'], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': ['四废日'], '甲申': []},
    '未': {'辛卯': [],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': ['乞丐贵人'], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': ['天转'], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['四废日'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [], '戊午': ['地转'], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': ['四废日'], '甲申': ['乞丐贵人']},


    '申': {'辛卯': [],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': ['地转'], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': ['天赦日'], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': ['四废日'], '乙卯': ['四废日'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': [], '辛酉': ['天转'], '壬戌': [], '癸亥': [], '甲申': []},
    '酉': {'辛卯': [],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': ['地转'], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': ['天赦日'], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': ['四废日'], '乙卯': ['四废日'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': [], '辛酉': ['天转'], '壬戌': [], '癸亥': [], '甲申': []},
    '戌': {'辛卯': [],'丙戊': [],'甲子': [],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': ['地转'], '甲戌': [], '乙亥': [], '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': ['天赦日'], '己酉': [], '庚戌': [], '辛亥': [], '壬子': [], '癸丑': [], '甲寅': ['四废日'], '乙卯': ['四废日'], '丙辰': [], '丁巳': [], '戊午': [], '己未': [], '庚申': [], '辛酉': ['天转'], '壬戌': [], '癸亥': [], '甲申': []},

    '亥': {'辛卯': [],'丙戊': ['四废日'],'甲子': ['天赦日'],'丙寅': [], '丁卯': [], '戊辰': [], '己巳': [], '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [], '丙子': ['地转'], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [], '壬辰': [], '癸巳': [], '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [], '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [], '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [], '壬子': ['天转'], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': ['四废日'], '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': [], '甲申': []}

}

# 8. 以年纳音查月支、日支、时支
DEITIES_LOOKUP_BY_YEAR_NAYIN_MULTI_BRANCH = {

    #增加
    '金': {
        'month': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['学堂词馆'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['学堂词馆'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['学堂词馆'], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '木': {
        'month': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': ['学堂词馆']},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': ['学堂词馆']},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': ['学堂词馆']}
    },
    '水': {
        'month': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []}
    },
    '火': {
        'month': {'子': [], '丑': [], '寅': ['学堂词馆'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': ['学堂词馆'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': ['学堂词馆'], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []}
    },
    '土': {
        'month': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []},
        'day': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []},
        'hour': {'子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [], '午': [], '未': [], '申': ['学堂词馆'], '酉': [], '戌': [], '亥': []}
    }
}

# 新增：根据日干查月支（用于月柱）
# 注:根据日干查月支
DEITIES_LOOKUP_BY_DAY_STEM_TO_MONTH_BRANCH = {
    '甲': {
        '子': ['财神贵人'], '丑': [], '寅': ['财神贵人'], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '乙': {
        '子': [], '丑': [], '寅': [], '卯': ['财神贵人'], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '丙': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': ['财神贵人'], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '丁': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': ['财神贵人'],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '戊': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': ['财神贵人'], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    },
    '己': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': ['财神贵人'], '申': [], '酉': [], '戌': [], '亥': []
    },
    '庚': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': ['财神贵人'], '酉': [], '戌': [], '亥': []
    },
    '辛': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': ['财神贵人'], '戌': [], '亥': []
    },
    '壬': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': ['财神贵人'], '亥': []
    },
    '癸': {
        '子': [], '丑': [], '寅': [], '卯': [], '辰': [], '巳': [],
        '午': [], '未': [], '申': [], '酉': [], '戌': [], '亥': []
    }
}

# 新增：以月支查日干（用于日柱）
# 注:以月支查日干
DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_DAY_STEM = {
    '子': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': ['乞丐贵人'], '癸': []
    },
    '丑': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '寅': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '卯': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '辰': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '巳': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '午': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '未': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '申': {
        '甲': [], '乙': ['乞丐贵人'], '丙': ['乞丐贵人'], '丁': ['乞丐贵人'], '戊': [],
        '己': [], '庚': [], '辛': [], '壬': [], '癸': []
    },
    '酉': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': [], '辛': ['乞丐贵人'], '壬': ['乞丐贵人'], '癸': ['乞丐贵人']
    },
    '戌': {
        '甲': ['乞丐贵人'], '乙': [], '丙': [], '丁': [], '戊': ['乞丐贵人'],
        '己': [], '庚': ['乞丐贵人'], '辛': [], '壬': [], '癸': []
    },
    '亥': {
        '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
        '己': [], '庚': ['乞丐贵人'], '辛': ['乞丐贵人'], '壬': [], '癸': []
    }
}

# 新增：以月支查日干、年干（用于日柱和年柱）
# 注:以月支查日干、年干
DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_DAY_YEAR_STEM = {
    '子': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        }
    },
    '丑': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        }
    },
    '寅': {
        'day_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        }
    },
    '卯': {
        'day_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        }
    },
    '辰': {
        'day_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': ['六亲贵人'], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': ['六亲贵人'], '辛': [], '壬': [], '癸': []
        }
    },
    '巳': {
        'day_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        }
    },
    '午': {
        'day_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        }
    },
    '未': {
        'day_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': ['六亲贵人'], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': ['六亲贵人'], '壬': [], '癸': []
        }
    },
    '申': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': ['六亲贵人'], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': ['六亲贵人'], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': ['六亲贵人'], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': ['六亲贵人'], '癸': []
        }
    },
    '酉': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': ['六亲贵人'], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': ['六亲贵人'], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': ['六亲贵人'], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': ['六亲贵人'], '癸': []
        }
    },
    '戌': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': ['六亲贵人'], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': ['六亲贵人'], '癸': []
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': [],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': []
        }
    },
    '亥': {
        'day_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        },
        'year_stem': {
            '甲': [], '乙': [], '丙': [], '丁': [], '戊': ['六亲贵人'],
            '己': [], '庚': [], '辛': [], '壬': [], '癸': ['六亲贵人']
        }
    }
}

# 新增：以日干查四柱（用于所有四柱，查完整干支）
# 注:以日干查四柱
DEITIES_LOOKUP_BY_DAY_STEM_TO_PILLARS = {
    '甲': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': ['天福贵人'], '壬戌': [], '癸亥': []
    },
    '乙': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': ['天福贵人'], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '丙': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '丁': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '戊': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': ['天福贵人'], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '己': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': ['天福贵人'], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '庚': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '辛': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '壬': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    },
    '癸': {
        '甲子': [], '乙丑': [], '丙寅': [], '丁卯': [], '戊辰': [], '己巳': [],
        '庚午': [], '辛未': [], '壬申': [], '癸酉': [], '甲戌': [], '乙亥': [],
        '丙子': [], '丁丑': [], '戊寅': [], '己卯': [], '庚辰': [], '辛巳': [],
        '壬午': [], '癸未': [], '甲申': [], '乙酉': [], '丙戌': [], '丁亥': [],
        '戊子': [], '己丑': [], '庚寅': [], '辛卯': [], '壬辰': [], '癸巳': [],
        '甲午': [], '乙未': [], '丙申': [], '丁酉': [], '戊戌': [], '己亥': [],
        '庚子': [], '辛丑': [], '壬寅': [], '癸卯': [], '甲辰': [], '乙巳': [],
        '丙午': [], '丁未': [], '戊申': [], '己酉': [], '庚戌': [], '辛亥': [],
        '壬子': [], '癸丑': [], '甲寅': [], '乙卯': [], '丙辰': [], '丁巳': [],
        '戊午': [], '己未': [], '庚申': [], '辛酉': [], '壬戌': [], '癸亥': []
    }
}

# 传统神煞规则（保留一些基础的神煞）
TRADITIONAL_DEITIES_RULES = {
    # 日干核心神煞
    # '天乙贵人': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['丑', '未'], '乙': ['申', '子'], '丙': ['酉', '亥'],
    #         '丁': ['酉', '亥'], '戊': ['丑', '未'], '己': ['申', '子'],
    #         '庚': ['丑', '未'], '辛': ['寅', '午'], '壬': ['卯', '巳'],
    #         '癸': ['卯', '巳']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '福星贵人': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['寅', '子'], '乙': ['寅', '子'], '丙': ['卯', '亥'],
    #         '丁': ['卯', '亥'], '戊': ['午', '酉'], '己': ['午', '酉'],
    #         '庚': ['午', '酉'], '辛': ['酉', '亥'], '壬': ['子', '辰'],
    #         '癸': ['子', '辰']
    #     },
    #     'reference': 'target_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '文昌贵人': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['巳', '午'], '乙': ['巳', '午'], '丙': ['申', '酉'],
    #         '丁': ['申', '酉'], '戊': ['申', '酉'], '己': ['申', '酉'],
    #         '庚': ['亥', '子'], '辛': ['亥', '子'], '壬': ['寅'], '癸': ['卯']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '流霞': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['酉'], '乙': ['戌'], '丙': ['亥'],
    #         '丁': ['子'], '戊': ['丑'], '己': ['寅'],
    #         '庚': ['卯'], '辛': ['辰'], '壬': ['巳'], '癸': ['午']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '学堂': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['亥'], '乙': ['午'], '丙': ['寅'], '丁': ['酉'],
    #         '戊': ['寅'], '己': ['酉'], '庚': ['巳'], '辛': ['子'],
    #         '壬': ['申'], '癸': ['卯']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '红艳煞': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['午'], '乙': ['申'], '丙': ['寅'], '丁': ['未'],
    #         '戊': ['辰'], '己': ['辰'], '庚': ['戌'], '辛': ['酉'],
    #         '壬': ['子'], '癸': ['申']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '阳刃': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['卯'], '乙': '', '丙': ['午'], '丁': '',
    #         '戊': ['午'], '己': '', '庚': ['酉'], '辛': '',
    #         '壬': ['子'], '癸': ''
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '羊刃': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['卯'], '乙': '', '丙': ['午'], '丁': '',
    #         '戊': ['午'], '己': '', '庚': ['酉'], '辛': '',
    #         '壬': ['子'], '癸': ''
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '太极贵人': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['子', '午'], '乙': ['子', '午'], '丙': ['卯', '酉'],
    #         '丁': ['卯', '酉'], '戊': ['辰', '戌', '丑', '未'], '己': ['辰', '戌', '丑', '未'],
    #         '庚': ['寅', '亥'], '辛': ['寅', '亥'], '壬': ['巳', '申'], '癸': ['巳', '申']
    #     },
    #     'reference': 'day_stem',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },



    # 特殊日柱神煞

    ##增加
    '阴差阳错': {
        'type': 'special_day',
        'rules': ['丙子', '丙午', '丁丑', '丁未', '戊寅', '戊申', '辛卯', '辛酉', '壬辰', '壬戌', '癸巳', '癸亥'],
        'pillars': ['day']
    },
    '孤鸾煞': {
        'type': 'special_day',
        'rules': ['甲寅', '乙巳', '丙午', '丁巳', '戊午', '戊申', '辛亥', '壬子'],
        'pillars': ['day']
    },
    '十恶大败': {
        'type': 'special_day',
        'rules': ['甲辰', '乙巳', '壬申', '丙申', '丁亥', '庚辰', '戊戌', '癸亥','辛巳','己丑'],
        'pillars': ['day']
    },
    '金神': {
        'type': 'special_day',
        'rules': ['乙丑', '己巳', '癸酉'],
        'pillars': ['day']
    },
    '六秀日': {
        'type': 'special_day',
        'rules': ['丙午', '丁未', '戊子', '戊午', '己丑', '己未'],
        'pillars': ['day']
    },
    '八专': {
        'type': 'special_day',
        'rules': ['甲寅', '乙卯', '丁未', '戊戌', '己未', '庚申', '辛酉', '癸丑'],
        'pillars': ['day']
    },
    '九丑': {
        'type': 'special_day',
        'rules': ['丁酉', '戊子', '戊午', '己卯', '己酉', '辛卯', '辛酉', '壬子', '壬午'],
        'pillars': ['day']
    },
    '十灵日': {
        'type': 'special_day',
        'rules': ['甲辰', '乙亥', '丙辰', '丁酉', '戊午', '庚戌', '庚寅', '辛亥', '壬寅', '癸未'],
        'pillars': ['day']
    },
    # '国印贵人': {
    #     'type': 'stem_branch_combo',
    #     'rules': {
    #         '甲': ['戌'], '乙': ['亥'], '丙': ['子'], '丁': ['丑'],
    #         '戊': ['寅'], '己': ['卯'], '庚': ['辰'], '辛': ['巳'],
    #         '壬': ['午'], '癸': ['未']
    #     },
    #     'reference': 'target_stem',
    #     'pillars': ['year', 'month', 'day']
    # },
    # '天罗地网': {
    #     'type': 'special_day',
    #     'rules': ['甲辰', '甲戌', '乙巳', '乙亥', '丙午', '丙子', '丁未', '丁丑', '戊申', '戊寅', '己酉', '己卯', '庚戌', '庚辰', '辛亥', '辛巳', '壬子', '壬午', '癸丑', '癸未'],
    #     'pillars': ['year', 'month', 'day']
    # },
    # '德秀贵人': {
    #     'type': 'branch_combo',
    #     'rules': {'丑': '庚', '寅': '丙', '午': '丙', '戌': '丙', '亥': '甲', '卯': '甲', '未': '甲', '申': '壬', '子': '壬', '辰': '壬', '巳': '庚', '酉': '庚'},
    #     'reference': 'month_branch',
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },

    ##增加
    '魁罡': {
        'type': 'special_day',
        'rules': ['庚辰', '庚戌', '壬辰', '戊戌'],
        'pillars': ['day']
    },
    # '勾绞煞': {
    #     'type': 'special_day',
    #     'rules': ['甲子', '甲午', '乙丑', '乙未', '丙寅', '丙申', '丁卯', '丁酉', '戊辰', '戊戌', '己巳', '己亥', '庚午', '庚子', '辛未', '辛丑', '壬申', '壬寅', '癸酉', '癸卯', '壬辰'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '童子煞': {
    #     'type': 'special_day',
    #     'rules': ['甲子', '甲午', '乙丑', '乙未', '丙寅', '丙申', '丁卯', '丁酉', '戊辰', '戊戌', '己巳', '己亥', '庚午', '庚子', '辛未', '辛丑', '壬申', '壬寅', '癸酉', '癸卯', '壬辰'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '地网': {
    #     'type': 'special_day',
    #     'rules': ['甲子', '甲午', '乙丑', '乙未', '丙寅', '丙申', '丁卯', '丁酉', '戊辰', '戊戌', '己巳', '己亥', '庚午', '庚子', '辛未', '辛丑', '壬申', '壬寅', '癸酉', '癸卯', '壬辰'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '六秀': {
    #     'type': 'special_day',
    #     'rules': ['戊子', '戊午', '己丑', '己未', '丙午', '丁未', '戊寅', '戊申'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '日德': {
    #     'type': 'special_day',
    #     'rules': ['甲寅', '丙辰', '戊辰', '庚辰', '壬戌'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '八专': {
    #     'type': 'special_day',
    #     'rules': ['甲寅', '乙卯', '丁未', '戊戌', '己未', '庚申', '辛酉', '癸丑'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # '九丑': {
    #     'type': 'special_day',
    #     'rules': ['戊子', '戊午', '壬子', '壬午', '乙卯', '己卯', '辛卯', '乙酉', '辛酉', '己酉'],
    #     'pillars': ['year', 'month', 'day', 'hour']
    # },
    # 新增特殊神煞
    '三奇贵人': {
        'type': 'three_noble_stems',
        'pillars': ['year', 'month', 'day', 'hour']
    }
    # ,
    # '元男': {
    #     'type': 'special_day',
    #     'rules': [],
    #     'pillars': ['day']
    # }
}

# 空亡规则
KONGWANG_RULES = {
    '甲子': ['戌', '亥'], '乙丑': ['戌', '亥'], '丙寅': ['戌', '亥'], '丁卯': ['戌', '亥'],
    '戊辰': ['戌', '亥'], '己巳': ['戌', '亥'], '庚午': ['戌', '亥'], '辛未': ['戌', '亥'],
    '壬申': ['戌', '亥'], '癸酉': ['戌', '亥'], '甲戌': ['申', '酉'], '乙亥': ['申', '酉'],
    '丙子': ['申', '酉'], '丁丑': ['申', '酉'], '戊寅': ['申', '酉'], '己卯': ['申', '酉'],
    '庚辰': ['申', '酉'], '辛巳': ['申', '酉'], '壬午': ['申', '酉'], '癸未': ['申', '酉'],
    '甲申': ['午', '未'], '乙酉': ['午', '未'], '丙戌': ['午', '未'], '丁亥': ['午', '未'],
    '戊子': ['午', '未'], '己丑': ['午', '未'], '庚寅': ['午', '未'], '辛卯': ['午', '未'],
    '壬辰': ['午', '未'], '癸巳': ['午', '未'], '甲午': ['辰', '巳'], '乙未': ['辰', '巳'],
    '丙申': ['辰', '巳'], '丁酉': ['辰', '巳'], '戊戌': ['辰', '巳'], '己亥': ['辰', '巳'],
    '庚子': ['辰', '巳'], '辛丑': ['辰', '巳'], '壬寅': ['辰', '巳'], '癸卯': ['辰', '巳'],
    '甲辰': ['寅', '卯'], '乙巳': ['寅', '卯'], '丙午': ['寅', '卯'], '丁未': ['寅', '卯'],
    '戊申': ['寅', '卯'], '己酉': ['寅', '卯'], '庚戌': ['寅', '卯'], '辛亥': ['寅', '卯'],
    '壬子': ['寅', '卯'], '癸丑': ['寅', '卯'], '甲寅': ['子', '丑'], '乙卯': ['子', '丑'],
    '丙辰': ['子', '丑'], '丁巳': ['子', '丑'], '戊午': ['子', '丑'], '己未': ['子', '丑'],
    '庚申': ['子', '丑'], '辛酉': ['子', '丑'], '壬戌': ['子', '丑'], '癸亥': ['子', '丑']
}

class DeitiesCalculator:
    def __init__(self):

        # 新增的配置
        self.lookup_by_day_branch_to_others = DEITIES_LOOKUP_BY_DAY_BRANCH_TO_OTHERS
        self.lookup_by_month_branch_to_others = DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_OTHERS
        self.lookup_by_year_branch_to_others = DEITIES_LOOKUP_BY_YEAR_BRANCH_TO_OTHERS

        self.lookup_by_day_branch = DEITIES_LOOKUP_BY_DAY_BRANCH
        self.lookup_by_day_stem = DEITIES_LOOKUP_BY_DAY_STEM
        self.traditional_rules = TRADITIONAL_DEITIES_RULES
        self.kongwang_rules = KONGWANG_RULES

        # 新增的神煞对照表
        self.lookup_by_year_stem = DEITIES_LOOKUP_BY_YEAR_STEM
        self.lookup_by_year_branch = DEITIES_LOOKUP_BY_YEAR_BRANCH
        self.lookup_by_month_stem = DEITIES_LOOKUP_BY_MONTH_STEM
        self.lookup_by_month_branch = DEITIES_LOOKUP_BY_MONTH_BRANCH
        self.lookup_by_month_branch_stem = DEITIES_LOOKUP_BY_MONTH_BRANCH_STEM
        self.lookup_by_year_nayin_day_branch = DEITIES_LOOKUP_BY_YEAR_NAYIN_DAY_BRANCH
        self.lookup_by_month_branch_day_pillar = DEITIES_LOOKUP_BY_MONTH_BRANCH_DAY_PILLAR
        self.lookup_by_year_nayin_multi_branch = DEITIES_LOOKUP_BY_YEAR_NAYIN_MULTI_BRANCH
        
        # 新增的4种查找方法
        self.lookup_by_day_stem_to_month_branch = DEITIES_LOOKUP_BY_DAY_STEM_TO_MONTH_BRANCH
        self.lookup_by_month_branch_to_day_stem = DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_DAY_STEM
        self.lookup_by_month_branch_to_day_year_stem = DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_DAY_YEAR_STEM
        self.lookup_by_day_stem_to_pillars = DEITIES_LOOKUP_BY_DAY_STEM_TO_PILLARS




    def calculate_deities_by_day_branch(self, day_branch, target_pillar_type, target_branch, bazi_pillars):
        """以日支查年支、月支、时支"""
        deities = []
        day_branch_map = DEITIES_LOOKUP_BY_DAY_BRANCH_TO_OTHERS.get(day_branch, {})
        pillar_map = day_branch_map.get(target_pillar_type, {})
        deities.extend(pillar_map.get(target_branch, []))
        return deities

    def calculate_deities_by_month_branch(self, month_branch, target_pillar_type, target_branch, bazi_pillars):
        """以月支查年支、日支、时支"""
        deities = []
        month_branch_map = DEITIES_LOOKUP_BY_MONTH_BRANCH_TO_OTHERS.get(month_branch, {})
        pillar_map = month_branch_map.get(target_pillar_type, {})
        deities.extend(pillar_map.get(target_branch, []))
        return deities

    def calculate_deities_by_year_branch(self, year_branch, target_pillar_type, target_branch, bazi_pillars):
        """以年支查日支、月支、时支"""
        deities = []
        year_branch_map = DEITIES_LOOKUP_BY_YEAR_BRANCH_TO_OTHERS.get(year_branch, {})
        pillar_map = year_branch_map.get(target_pillar_type, {})
        deities.extend(pillar_map.get(target_branch, []))
        return deities


    def calculate_year_deities(self, stem, branch, bazi_pillars):
        """计算年柱神煞"""
        return self._calculate_deities_by_lookup_table('year', stem, branch, bazi_pillars)

    def calculate_month_deities(self, stem, branch, bazi_pillars):
        """计算月柱神煞"""
        return self._calculate_deities_by_lookup_table('month', stem, branch, bazi_pillars)

    def calculate_day_deities(self, stem, branch, bazi_pillars):
        """计算日柱神煞"""
        return self._calculate_deities_by_lookup_table('day', stem, branch, bazi_pillars)

    def calculate_hour_deities(self, stem, branch, bazi_pillars):
        """计算时柱神煞"""
        return self._calculate_deities_by_lookup_table('hour', stem, branch, bazi_pillars)

    def _calculate_deities_by_lookup_table(self, pillar_type, stem, branch, bazi_pillars):
        """统一的神煞查找逻辑 - 所有柱都使用相同的逻辑"""
        deities = []
        day_branch = bazi_pillars['day']['branch']  # 日支作为行基准
        day_stem = bazi_pillars['day']['stem']  # 日干作为行基准
        current_branch = branch  # 当前柱的地支作为列基准

        # 1. 基于日支的查找
        deities.extend(self._lookup_by_day_branch(day_branch, current_branch))

        # 2. 基于日干的查找
        deities.extend(self._lookup_by_day_stem(day_stem, current_branch))

        # 3. 新增的神煞查找方法
        deities.extend(self._calculate_new_deities(pillar_type, stem, branch, bazi_pillars))

        # 4. 添加传统神煞
        traditional_deities = self._calculate_traditional_deities(pillar_type, stem, branch, bazi_pillars)
        deities.extend(traditional_deities)



        # 5. 添加空亡检查
        kongwang_results = self.calculate_all_kongwang(bazi_pillars)
        if pillar_type in kongwang_results and kongwang_results[pillar_type]:
            deities.extend(kongwang_results[pillar_type])


        return list(set(deities))  # 去重

    def _calculate_new_deities(self, pillar_type, stem, branch, bazi_pillars):
        """计算新增的神煞"""
        deities = []

        year_stem = bazi_pillars['year']['stem']
        year_branch = bazi_pillars['year']['branch']
        month_stem = bazi_pillars['month']['stem']
        month_branch = bazi_pillars['month']['branch']
        day_stem = bazi_pillars['day']['stem']
        day_branch = bazi_pillars['day']['branch']
        hour_branch = bazi_pillars['hour']['branch']



        # 新增的三种查询方法
        # day_branch = bazi_pillars['day']['branch']
        # month_branch = bazi_pillars['month']['branch']
        # year_branch = bazi_pillars['year']['branch']

        # 1. 以日支查年支、月支、时支
        if pillar_type in ['year', 'month', 'hour']:
            deities.extend(self.calculate_deities_by_day_branch(day_branch, pillar_type, branch, bazi_pillars))

        # 2. 以月支查年支、日支、时支
        if pillar_type in ['year', 'day', 'hour']:
            deities.extend(self.calculate_deities_by_month_branch(month_branch, pillar_type, branch, bazi_pillars))

        # 3. 以年支查日支、月支、时支
        if pillar_type in ['day', 'month', 'hour']:
            deities.extend(self.calculate_deities_by_year_branch(year_branch, pillar_type, branch, bazi_pillars))



        # 1. 以年干为列，其他支为行
        if pillar_type in ['year', 'month', 'day', 'hour']:
            year_stem_map = self.lookup_by_year_stem.get(year_stem, {})
            deities.extend(year_stem_map.get(branch, []))

        # 2. 以年支为列，其他支为行
        if pillar_type in ['year', 'month', 'day', 'hour']:
            year_branch_map = self.lookup_by_year_branch.get(year_branch, {})
            deities.extend(year_branch_map.get(branch, []))

        # 3. 以月干为列，其他支为行
        if pillar_type in ['year', 'month', 'day', 'hour']:
            month_stem_map = self.lookup_by_month_stem.get(month_stem, {})
            deities.extend(month_stem_map.get(branch, []))

        # 4. 以月支为列，其他支为行
        if pillar_type in ['year', 'month', 'day', 'hour']:
            month_branch_map = self.lookup_by_month_branch.get(month_branch, {})
            deities.extend(month_branch_map.get(branch, []))

        # 5. 以月支为列，其他干支为行
        if pillar_type in ['year', 'month', 'day', 'hour']:
            month_branch_stem_map = self.lookup_by_month_branch_stem.get(month_branch, {})
            deities.extend(month_branch_stem_map.get(stem, []))

        # 6. 以年纳音查日支 - 专门用于日柱
        if pillar_type == 'day':
            # 这里需要年纳音信息，暂时用空字符串代替
            year_nayin = self._get_year_nayin(bazi_pillars['year']['stem'], bazi_pillars['year']['branch'])
            nayin_day_map = self.lookup_by_year_nayin_day_branch.get(year_nayin, {})


            # # 添加打印语句
            # logger.info(f"-----------------------年纳音 year_nayin: {year_nayin}")
            # logger.info(f"-----------------------纳音日支映射 nayin_day_map: {nayin_day_map}")
            # logger.info(f"-----------------------当前日支: {branch}")
            # logger.info(f"-----------------------纳音日支映射获取结果: {nayin_day_map.get(branch, [])}")

            deities.extend(nayin_day_map.get(branch, []))



        # 7. 以月支查日柱 - 专门用于日柱
        if pillar_type == 'day':
            day_pillar = f"{stem}{branch}"
            month_branch_day_map = self.lookup_by_month_branch_day_pillar.get(month_branch, {})
            deities.extend(month_branch_day_map.get(day_pillar, []))

        # 8. 以年纳音查月支、日支、时支
        year_nayin = self._get_year_nayin(bazi_pillars['year']['stem'], bazi_pillars['year']['branch'])
        nayin_multi_map = self.lookup_by_year_nayin_multi_branch.get(year_nayin, {})

        if pillar_type == 'month':
            month_map = nayin_multi_map.get('month', {})
            deities.extend(month_map.get(branch, []))
        elif pillar_type == 'day':
            day_map = nayin_multi_map.get('day', {})
            deities.extend(day_map.get(branch, []))
        elif pillar_type == 'hour':
            hour_map = nayin_multi_map.get('hour', {})
            deities.extend(hour_map.get(branch, []))

        # 9. 根据日干查月支（专门用于月柱）
        # 注:根据日干查月支
        if pillar_type == 'month':
            day_stem_month_map = self.lookup_by_day_stem_to_month_branch.get(day_stem, {})
            deities.extend(day_stem_month_map.get(branch, []))

        # 10. 以月支查日干（专门用于日柱）
        # 注:以月支查日干
        if pillar_type == 'day':
            month_branch_day_stem_map = self.lookup_by_month_branch_to_day_stem.get(month_branch, {})
            deities.extend(month_branch_day_stem_map.get(stem, []))

        # 11. 以月支查日干、年干（用于日柱和年柱）
        # 注:以月支查日干、年干
        month_branch_stem_map = self.lookup_by_month_branch_to_day_year_stem.get(month_branch, {})
        if pillar_type == 'day':
            day_stem_map = month_branch_stem_map.get('day_stem', {})
            deities.extend(day_stem_map.get(stem, []))
        elif pillar_type == 'year':
            year_stem_map = month_branch_stem_map.get('year_stem', {})
            deities.extend(year_stem_map.get(stem, []))

        # 12. 以日干查四柱（查完整干支，不是只查地支）
        # 注:以日干查四柱
        if pillar_type in ['year', 'month', 'day', 'hour']:
            current_pillar = f"{stem}{branch}"  # 当前柱的完整干支
            day_stem_pillar_map = self.lookup_by_day_stem_to_pillars.get(day_stem, {})
            deities.extend(day_stem_pillar_map.get(current_pillar, []))

        return deities

    def _get_year_nayin(self, year_stem, year_branch):
        """获取年柱纳音"""
        # 六十甲子纳音表
        nayin_map = {
        '甲子': '金', '乙丑': '金', '丙寅': '火', '丁卯': '火', '戊辰': '木', '己巳': '木',
        '庚午': '土', '辛未': '土', '壬申': '金', '癸酉': '金', '甲戌': '火', '乙亥': '火',
        '丙子': '水', '丁丑': '水', '戊寅': '土', '己卯': '土', '庚辰': '金', '辛巳': '金',
        '壬午': '木', '癸未': '木', '甲申': '水', '乙酉': '水', '丙戌': '土', '丁亥': '土',
        '戊子': '火', '己丑': '火', '庚寅': '木', '辛卯': '木', '壬辰': '水', '癸巳': '水',
        '甲午': '金', '乙未': '金', '丙申': '火', '丁酉': '火', '戊戌': '木', '己亥': '木',
        '庚子': '土', '辛丑': '土', '壬寅': '金', '癸卯': '金', '甲辰': '火', '乙巳': '火',
        '丙午': '水', '丁未': '水', '戊申': '土', '己酉': '土', '庚戌': '金', '辛亥': '金',
        '壬子': '木', '癸丑': '木', '甲寅': '水', '乙卯': '水', '丙辰': '土', '丁巳': '土',
        '戊午': '火', '己未': '火', '庚申': '木', '辛酉': '木', '壬戌': '水', '癸亥': '水'
    }

        year_pillar = f"{year_stem}{year_branch}"
        return nayin_map.get(year_pillar, "")

    def _lookup_by_day_branch(self, day_branch, current_branch):
        """基于日支查找神煞 - 处理列表格式"""
        deities = []
        # 遍历对照表，查找包含日支的行键
        for row_key, branch_map in self.lookup_by_day_branch.items():
            # 检查日支是否匹配行表头
            if self._match_row_key(day_branch, row_key):
                # 根据当前柱地支查找对应的神煞列表
                deity_list = branch_map.get(current_branch, [])
                deities.extend(deity_list)
        return deities

    def _lookup_by_day_stem(self, day_stem, current_branch):
        """基于日干查找神煞 - 处理列表格式"""
        deities = []
        # 直接根据日干查找对应的配置
        stem_map = self.lookup_by_day_stem.get(day_stem, {})
        deity_list = stem_map.get(current_branch, [])
        deities.extend(deity_list)
        return deities

    def _match_row_key(self, branch, row_key):
        """检查地支是否匹配行表头"""
        if len(row_key) == 1:
            # 单个地支
            return branch == row_key
        elif len(row_key) == 3:
            # 三个地支的组合，只要匹配其中一个即可
            return branch in row_key
        return False

    # def calculate_kongwang(self, stem, branch):
    #     day_pillar = f"{stem}{branch}"
    #     return self.kongwang_rules.get(day_pillar, [])


    def calculate_kongwang(self, pillar_stem, pillar_branch):
        """计算空亡 - 修正版本"""
        # 空亡是以日柱为基准，查其他柱的地支
        day_pillar = f"{pillar_stem}{pillar_branch}"
        kongwang_branches = self.kongwang_rules.get(day_pillar, [])
        return kongwang_branches

    def calculate_all_kongwang(self, bazi_pillars):
        """计算所有柱的空亡状态"""
        kongwang_results = {}
        day_stem = bazi_pillars['day']['stem']
        day_branch = bazi_pillars['day']['branch']

        # 获取日柱的空亡地支
        kongwang_branches = self.calculate_kongwang(day_stem, day_branch)

        # 检查各柱是否在空亡地支中
        for pillar_type, pillar in bazi_pillars.items():
            if pillar['branch'] in kongwang_branches:
                kongwang_results[pillar_type] = ['空亡']
            else:
                kongwang_results[pillar_type] = []

        return kongwang_results






    def _calculate_traditional_deities(self, pillar_type, stem, branch, bazi_pillars):
        """计算传统神煞"""
        deities = []
        for deity_name, rule_config in self.traditional_rules.items():
            if pillar_type not in rule_config.get('pillars', []):
                continue
            if self._check_deity_rule(deity_name, rule_config, pillar_type, stem, branch, bazi_pillars):
                deities.append(deity_name)
        return deities

    def _check_deity_rule(self, deity_name, rule_config, pillar_type, stem, branch, bazi_pillars):
        """检查传统神煞规则"""
        rule_type = rule_config['type']
        rule_config['deity_name'] = deity_name

        if rule_type == 'stem_branch_combo':
            return self._check_stem_branch_combo(rule_config, pillar_type, stem, branch, bazi_pillars)
        elif rule_type == 'branch_combo':
            return self._check_branch_combo(rule_config, pillar_type, stem, branch, bazi_pillars)
        elif rule_type == 'special_day':
            return self._check_special_day(rule_config, pillar_type, stem, branch, bazi_pillars)
        elif rule_type == 'three_continuous_stems':
            return self._check_three_continuous_stems(rule_config, pillar_type, stem, branch, bazi_pillars)

        return False

    def _check_stem_branch_combo(self, rule_config, pillar_type, stem, branch, bazi_pillars):
        """检查天干地支组合规则"""
        reference = rule_config['reference']
        rules = rule_config['rules']

        if reference == 'day_stem':
            target_stem = bazi_pillars['day']['stem']
        elif reference == 'hour_stem':
            target_stem = bazi_pillars['hour']['stem']
        elif reference == 'target_stem':
            target_stem = stem
        else:
            target_stem = stem

        target_branches = rules.get(target_stem)
        if isinstance(target_branches, list):
            return branch in target_branches
        elif isinstance(target_branches, str):
            return branch == target_branches
        return False

    def _check_branch_combo(self, rule_config, pillar_type, stem, branch, bazi_pillars):
        """检查地支组合规则"""
        reference = rule_config['reference']
        rules = rule_config['rules']

        if reference == 'year_branch':
            target_branch = bazi_pillars['year']['branch']
        elif reference == 'month_branch':
            target_branch = bazi_pillars['month']['branch']
        elif reference == 'day_branch':
            target_branch = bazi_pillars['day']['branch']
        elif reference == 'hour_branch':
            target_branch = bazi_pillars['hour']['branch']
        elif reference == 'target_branch':
            target_branch = branch
        else:
            target_branch = branch

        target_branch_result = rules.get(target_branch)

        # 特殊处理德秀贵人
        if rule_config.get('deity_name') == '德秀贵人':
            if reference == 'month_branch':
                if pillar_type == 'year':
                    return target_branch_result == bazi_pillars['year']['stem']
                elif pillar_type == 'month':
                    return target_branch_result == bazi_pillars['month']['stem']
                elif pillar_type == 'day':
                    return target_branch_result == bazi_pillars['day']['stem']
                elif pillar_type == 'hour':
                    return target_branch_result == bazi_pillars['hour']['stem']

        if isinstance(target_branch_result, list):
            return branch in target_branch_result
        elif isinstance(target_branch_result, str):
            return branch == target_branch_result
        return False

    def _check_special_day(self, rule_config, pillar_type, stem, branch, bazi_pillars):
        """检查特殊日柱规则"""
        pillar_combination = f"{stem}{branch}"
        return pillar_combination in rule_config['rules']

    def _check_three_continuous_stems(self, rule_config, pillar_type, stem, branch, bazi_pillars):
        """检查三奇贵人规则 - 修正版本"""

        # 检查三天干相连
        stems = [
            bazi_pillars['year']['stem'],
            bazi_pillars['month']['stem'],
            bazi_pillars['day']['stem'],
            bazi_pillars['hour']['stem']
        ]
            # 三奇贵人的三种组合
        three_noble_patterns = [
            ['甲', '戊', '庚'],  # 天上三奇
            ['乙', '丙', '丁'],  # 地上三奇
            ['壬', '癸', '辛']   # 人中三奇
        ]
        # 检查是否包含完整的三奇组合
        for pattern in three_noble_patterns:
            if all(stem in stems for stem in pattern):
                # 检查顺序：年月日或月日时连续出现
                stem_string = ''.join(stems)
                pattern_string = ''.join(pattern)
                if pattern_string in stem_string:
                    return True

        return False

    def _are_stems_continuous(self, stem1, stem2, stem3):
        """检查三个天干是否连续"""
        stem_order = ['甲', '乙', '丙', '丁', '戊', '己', '庚', '辛', '壬', '癸']
        try:
            idx1 = stem_order.index(stem1)
            idx2 = stem_order.index(stem2)
            idx3 = stem_order.index(stem3)
            return (idx2 == idx1 + 1 and idx3 == idx2 + 1) or (idx2 == idx1 - 1 and idx3 == idx2 - 1)
        except ValueError:
            return False

    def _are_branches_continuous(self, branch1, branch2, branch3):
        """检查三个地支是否连续"""
        branch_order = ['子', '丑', '寅', '卯', '辰', '巳', '午', '未', '申', '酉', '戌', '亥']
        try:
            idx1 = branch_order.index(branch1)
            idx2 = branch_order.index(branch2)
            idx3 = branch_order.index(branch3)
            return (idx2 == idx1 + 1 and idx3 == idx2 + 1) or (idx2 == idx1 - 1 and idx3 == idx2 - 1)
        except ValueError:
            return False