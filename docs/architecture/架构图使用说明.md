# HiFate-bazi 生产环境架构图使用说明

## 📋 文件说明

**架构图文件**：`docs/architecture/HiFate-bazi-生产环境架构图.drawio`

**格式**：Draw.io XML 格式

**工具**：Draw.io (diagrams.net)

---

## 🚀 如何使用

### 方法一：在线使用（推荐）

1. **打开 Draw.io 网站**：
   - 访问：https://app.diagrams.net/
   - 或访问：https://www.draw.io/

2. **导入架构图**：
   - 点击 "Open Existing Diagram"
   - 选择文件：`docs/architecture/HiFate-bazi-生产环境架构图.drawio`
   - 或直接拖拽文件到浏览器

3. **编辑和查看**：
   - 可以查看完整的架构图
   - 可以编辑和修改
   - 可以导出为 PNG、SVG、PDF 等格式

### 方法二：VS Code 插件

1. **安装插件**：
   - 在 VS Code 中搜索并安装 "Draw.io Integration" 插件

2. **打开文件**：
   - 直接在 VS Code 中打开 `.drawio` 文件
   - 会自动在编辑器中显示架构图

3. **编辑**：
   - 可以直接在 VS Code 中编辑架构图

### 方法三：桌面应用

1. **下载 Draw.io Desktop**：
   - 访问：https://github.com/jgraph/drawio-desktop/releases
   - 下载对应操作系统的版本

2. **打开文件**：
   - 使用 Draw.io Desktop 打开 `.drawio` 文件

---

## 📊 架构图内容

### 包含的组件

1. **Node1 (主节点)**
   - 公网 IP: 8.210.52.217
   - 内网 IP: 172.18.121.222
   - Nginx (80/443)
   - Web 服务 (8001)
   - MySQL 主库 (3306)
   - Redis 主库 (6379)
   - 10 个微服务 (9001-9010)

2. **Node2 (从节点)**
   - 公网 IP: 47.243.160.43
   - 内网 IP: 172.18.121.223
   - Nginx (80/443)
   - Web 服务 (8001)
   - MySQL 从库 (3306)
   - Redis 从库 (6379)
   - 10 个微服务 (9001-9010)

3. **连接关系**
   - 用户请求 → Nginx
   - Nginx → Web 服务（负载均衡）
   - Web 服务 → MySQL/Redis
   - Web 服务 → 微服务（gRPC）
   - MySQL 主从复制
   - Redis 主从复制
   - Nginx 负载均衡

### 颜色说明

- **黄色** (#FFF2CC): Nginx 服务
- **绿色** (#D5E8D4): Web 服务和微服务
- **红色** (#F8CECC): MySQL 数据库
- **紫色** (#E1D5E7): Redis 缓存
- **蓝色** (#E1F5FF): 用户/客户端

### 连接线说明

- **实线**：直接连接
- **虚线**：跨节点连接
- **粗虚线**：主从复制
- **箭头**：数据流向

---

## 🎨 自定义修改

### 修改组件

1. **选择组件**：点击架构图中的任意组件
2. **编辑属性**：
   - 修改文本内容
   - 修改颜色和样式
   - 调整位置和大小

3. **添加组件**：
   - 从左侧工具栏拖拽新组件
   - 或复制现有组件并修改

### 修改连接

1. **选择连接线**：点击连接线
2. **编辑属性**：
   - 修改标签文本
   - 修改线条样式（实线/虚线）
   - 修改颜色和粗细

3. **添加连接**：
   - 从组件边缘拖拽创建新连接
   - 或使用连接工具

### 导出格式

1. **PNG 图片**：
   - File → Export as → PNG
   - 适合文档和演示

2. **SVG 矢量图**：
   - File → Export as → SVG
   - 适合打印和缩放

3. **PDF 文档**：
   - File → Export as → PDF
   - 适合文档归档

4. **其他格式**：
   - JPG、XML、HTML 等

---

## 📝 更新架构图

### 何时更新

- 新增服务或组件
- 修改服务器 IP 地址
- 修改端口配置
- 修改网络连接关系
- 修改部署架构

### 更新步骤

1. **打开架构图文件**
2. **修改相应组件**
3. **保存文件**
4. **提交到 Git**：
   ```bash
   git add docs/architecture/HiFate-bazi-生产环境架构图.drawio
   git commit -m "docs: 更新生产环境架构图"
   git push
   ```

---

## 🔍 查看架构图

### 在线预览

如果文件已提交到 Git 仓库，可以在 GitHub/Gitee 上直接查看（如果支持）。

### 本地查看

1. **使用 Draw.io 在线工具**（推荐）
2. **使用 VS Code 插件**
3. **使用 Draw.io Desktop**

---

## 📚 相关文档

- **生产环境架构和部署规范**：`docs/root_docs/生产环境架构和部署规范.md`
- **双机部署指南**：`docs/root_docs/生产环境双机部署指南.md`
- **部署最终报告**：`docs/root_docs/生产环境双机部署最终报告.md`

---

## ⚠️ 注意事项

1. **文件格式**：`.drawio` 文件是 XML 格式，可以用文本编辑器打开，但不建议直接编辑
2. **版本控制**：建议将架构图文件提交到 Git 仓库，方便版本管理
3. **备份**：修改前建议先备份原文件
4. **兼容性**：Draw.io 格式兼容性好，可以在不同平台使用

---

## 🎯 快速开始

1. **打开 Draw.io**：https://app.diagrams.net/
2. **导入文件**：选择 `docs/architecture/HiFate-bazi-生产环境架构图.drawio`
3. **查看架构**：浏览完整的生产环境架构
4. **导出图片**：导出为 PNG 或 PDF 用于文档

---

**最后更新**：2025-01-21

