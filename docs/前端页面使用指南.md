# 智能意图识别系统 - 前端页面使用指南

**更新时间**：2025-11-24

---

## 📱 可用页面

### 1. 智能运势分析（完整版）

**页面路径**：`frontend/smart-fortune.html`

**访问地址**：`http://localhost:8001/frontend/smart-fortune.html`

**功能**：
- ✅ 输入问题进行意图识别
- ✅ 输入八字信息（年月日时辰、性别）
- ✅ 显示识别意图和置信度
- ✅ 显示完整的八字信息（四柱）
- ✅ 显示智能分析结果
- ✅ 匹配规则统计

**适用场景**：
- 完整的运势分析
- 需要八字计算的场景
- 正式的用户界面

**截图预览**：
```
┌─────────────────────────────────┐
│   🔮 智能运势分析               │
│   基于AI的问题意图识别          │
├─────────────────────────────────┤
│ 💬 您的问题                     │
│ ┌─────────────────────────────┐ │
│ │ 我的事业运势怎么样？        │ │
│ └─────────────────────────────┘ │
│                                 │
│ 💡 示例问题（点击填入）         │
│ [事业运势] [财富运势] [婚姻感情]│
│                                 │
│ 📅 您的出生信息                 │
│ 年：[1990] 月：[1] 日：[1]     │
│ 时辰：[12] 性别：[男]           │
│                                 │
│     [🚀 开始智能分析]           │
├─────────────────────────────────┤
│ 🎯 意图识别结果                 │
│ 识别意图：[事业运势]            │
│ 置信度：95% ████████████▌       │
│                                 │
│ 📊 八字信息                     │
│ 日主：甲子                      │
│ [年柱] [月柱] [日柱] [时柱]    │
│                                 │
│ 💬 智能分析结果                 │
│ 根据您的问题...                 │
└─────────────────────────────────┘
```

---

### 2. 意图识别测试（简化版）

**页面路径**：`frontend/intent-test.html`

**访问地址**：`http://localhost:8001/frontend/intent-test.html`

**功能**：
- ✅ 快速测试问题意图识别
- ✅ 实时显示识别结果
- ✅ 显示置信度、关键词、推理过程
- ✅ 测试历史记录（最近20条）
- ✅ 响应时间统计

**适用场景**：
- 快速测试意图识别准确性
- 调试和验证
- 不需要八字信息的场景
- 开发测试

**截图预览**：
```
┌─────────────────────────────────┐
│   🎯 意图识别测试工具           │
│   快速测试AI意图识别能力        │
├─────────────────────────────────┤
│ ┌─────────────────────────────┐ │
│ │ 我的事业运势怎么样？  [测试]│ │
│ └─────────────────────────────┘ │
│                                 │
│ [事业] [财富] [婚姻] [健康]    │
│ [性格] [复合] [专业] [模糊]    │
├─────────────────────────────────┤
│ 识别意图：[事业运势]            │
│ 置信度：95% ████████████▌       │
│ 关键词：事业 运势               │
│ 推理过程：用户明确询问事业运势  │
│ 是否模糊：否                    │
│                                 │
│ 响应时间  Prompt版本  规则类型  │
│   234ms      v1.0    CAREER    │
├─────────────────────────────────┤
│ 📋 测试历史                     │
│ • 我的事业运势怎么样？          │
│   事业 · 置信度 95% · 12:34:56 │
│ • 我能发财吗？                  │
│   财富 · 置信度 93% · 12:33:21 │
└─────────────────────────────────┘
```

---

## 🚀 快速开始

### 步骤1：确保服务已启动

```bash
# 检查服务状态
ps aux | grep -E "(start.py|intent_service)"

# 如果服务未启动，执行：
./start_all_services.sh

# 等待10秒让服务完全启动
```

### 步骤2：访问前端页面

#### 方式1：通过浏览器直接打开

```bash
# Mac
open http://localhost:8001/frontend/smart-fortune.html

# Linux
xdg-open http://localhost:8001/frontend/smart-fortune.html

# Windows
start http://localhost:8001/frontend/smart-fortune.html
```

#### 方式2：通过命令行打开本地文件

```bash
# 完整版
open frontend/smart-fortune.html

# 简化版
open frontend/intent-test.html
```

### 步骤3：开始测试

**完整版使用流程**：
1. 输入您的问题（或点击示例问题）
2. 填写八字信息（年月日时辰、性别）
3. 点击"开始智能分析"
4. 查看识别结果和运势分析

**简化版使用流程**：
1. 输入问题（或点击示例按钮）
2. 点击"测试"或按回车
3. 查看意图识别结果
4. 点击历史记录可快速重新测试

---

## 💡 使用技巧

### 1. 示例问题快速测试

两个页面都提供了常用的示例问题：
- **事业运势**："我的事业运势怎么样？"
- **财富运势**："我能发财吗？"
- **婚姻感情**："我什么时候结婚？"
- **健康运势**："我的身体健康吗？"
- **性格特点**："我是什么性格？"
- **复合问题**："我今年能赚钱吗？会升职吗？"
- **专业术语**："我的食神旺不旺？"
- **模糊问题**："我咋样？"

点击即可自动填入并测试。

### 2. 理解置信度

| 置信度范围 | 说明 | 建议 |
|-----------|------|------|
| 95-100% | 意图非常明确 | 结果可信度高 |
| 85-94% | 意图清晰 | 结果可靠 |
| 70-84% | 意图较明确 | 结果较可靠 |
| 50-69% | 意图模糊 | 建议更具体地描述 |
| <50% | 无法判断 | 请重新描述问题 |

### 3. 关键词帮助理解

系统会提取问题中的关键词，帮助您理解AI的识别依据。

示例：
- "我的**事业**运势怎么样？" → 关键词：事业、运势
- "我能**发财**吗？" → 关键词：发财
- "我的**食神**旺不旺？" → 关键词：食神、旺

### 4. 模糊问题的处理

当系统标记为"模糊"时，会给出建议：

```
💡 如需更精准的分析，建议您提出更具体的问题，例如：
"我今年的事业运势如何？"
"我什么时候会结婚？"
```

### 5. 使用测试历史

简化版测试工具会保存最近20条测试记录，点击历史记录可快速重新测试。

---

## 🎨 界面功能说明

### 完整版（smart-fortune.html）

#### 输入区域
- **问题输入框**：多行文本框，支持长问题
- **示例问题标签**：点击快速填入常见问题
- **八字信息**：年月日时辰、性别选择

#### 结果展示
1. **意图识别结果**
   - 识别到的意图（标签形式）
   - 置信度（百分比 + 进度条）
   - 提取的关键词
   - 是否模糊判断

2. **八字信息**
   - 日主
   - 四柱（年月日时）

3. **智能分析结果**
   - 完整的文字分析
   - 匹配的规则数量
   - 响应时间统计

### 简化版（intent-test.html）

#### 测试区域
- **快速输入**：单行输入框
- **示例按钮**：一键测试
- **测试按钮**：支持回车快捷键

#### 结果展示
1. **基本信息**
   - 识别意图
   - 置信度（进度条）
   - 关键词列表
   - 推理过程
   - 模糊判断

2. **统计信息**
   - 响应时间
   - Prompt版本
   - 规则类型

3. **测试历史**
   - 最近20条记录
   - 点击可重新测试

---

## 🔧 API地址配置

如果您的服务运行在不同的端口，需要修改API地址：

### 完整版（smart-fortune.html）

```javascript
// 第489行附近
const API_BASE_URL = 'http://localhost:8001';

// 如果服务在8000端口，改为：
const API_BASE_URL = 'http://localhost:8000';
```

### 简化版（intent-test.html）

```javascript
// 第319行附近
const API_URL = 'http://localhost:8001/api/v1/test-intent';

// 如果服务在8000端口，改为：
const API_URL = 'http://localhost:8000/api/v1/test-intent';
```

---

## 🐛 常见问题

### 问题1：页面无法访问

**症状**：浏览器显示"无法访问此网站"

**解决**：
```bash
# 1. 检查服务是否启动
ps aux | grep start.py

# 2. 检查端口是否监听
lsof -i :8001

# 3. 重启服务
./stop_all_services.sh
./start_all_services.sh
```

### 问题2：API请求失败

**症状**：页面显示"网络请求失败"

**解决**：
```bash
# 1. 检查Intent Service是否运行
ps aux | grep intent_service

# 2. 查看日志
tail -f logs/intent_service_9008.log

# 3. 手动测试API
curl "http://localhost:8001/api/v1/test-intent?question=测试"
```

### 问题3：显示结果异常

**症状**：识别结果显示不完整或错误

**解决**：
```bash
# 1. 清理浏览器缓存
# Chrome: Ctrl+Shift+Delete
# 或使用无痕模式测试

# 2. 查看浏览器控制台
# F12 → Console 标签
# 查看是否有JavaScript错误

# 3. 检查API返回
# F12 → Network 标签
# 查看API响应内容
```

### 问题4：置信度始终很低

**症状**：所有问题置信度都低于70%

**解决**：
```bash
# 1. 检查Coze Bot配置
# 确认Bot ID正确
grep INTENT_BOT_ID config/services.env

# 2. 检查Prompt版本
curl "http://localhost:8001/api/v1/test-intent?question=测试" | grep prompt_version

# 3. 查看详细日志
grep "confidence" logs/intent_service_9008.log | tail -20

# 4. 优化Coze Bot的Temperature参数
# 参考：docs/Coze_Bot配置文档-意图识别专家.md
```

---

## 📊 性能优化建议

### 1. 启用缓存（默认已启用）

第一次查询某个问题较慢（200-500ms），后续相同问题会命中缓存（<50ms）。

### 2. 批量测试

如需测试大量问题，使用简化版页面更高效。

### 3. 预热常见问题

系统启动后，预先测试常见问题以建立缓存：

```bash
# 运行预热脚本
cat > warm_cache.sh << 'EOF'
#!/bin/bash
questions=(
  "我的事业运势怎么样"
  "我能发财吗"
  "我什么时候结婚"
  "我的健康怎么样"
  "我是什么性格"
)

for q in "${questions[@]}"; do
  curl -s "http://localhost:8001/api/v1/test-intent?question=$q" > /dev/null
  echo "✓ 预热: $q"
done
EOF

chmod +x warm_cache.sh
./warm_cache.sh
```

---

## 📱 移动端适配

两个页面都已做移动端响应式适配，可在手机浏览器中正常使用。

**访问方式**：
1. 确保手机和电脑在同一局域网
2. 查看电脑IP地址（如：192.168.1.100）
3. 在手机浏览器中访问：
   - 完整版：`http://192.168.1.100:8001/frontend/smart-fortune.html`
   - 简化版：`http://192.168.1.100:8001/frontend/intent-test.html`

---

## 🎯 最佳实践

### 1. 开发测试流程

```
1. 使用简化版快速测试意图识别
   └─ 验证识别准确性
   
2. 确认识别无误后，使用完整版
   └─ 验证完整流程
   
3. 收集测试数据
   └─ 记录错误案例
   
4. 优化Prompt
   └─ 基于错误案例改进
```

### 2. 用户反馈收集

建议在页面中添加反馈按钮：

```html
<button onclick="sendFeedback(true)">👍 识别准确</button>
<button onclick="sendFeedback(false)">👎 识别错误</button>
```

### 3. A/B测试

使用简化版页面对比不同Prompt版本的效果：

```
1. 部署新Prompt版本（v1.1）
2. 使用相同测试集测试
3. 对比v1.0和v1.1的准确率
4. 选择更优版本
```

---

## 📚 相关文档

- [智能意图识别系统-开发完成报告](./智能意图识别系统-开发完成报告.md)
- [智能意图识别系统-使用指南](./智能意图识别系统-使用指南.md)
- [Coze Bot配置文档](./Coze_Bot配置文档-意图识别专家.md)

---

## 🆘 获取帮助

遇到问题时：

1. **查看浏览器控制台**：F12 → Console
2. **查看Network请求**：F12 → Network
3. **查看服务日志**：`tail -f logs/intent_service_9008.log`
4. **参考故障排查**：本文档"常见问题"章节

---

**页面已就绪，祝使用愉快！** 🎉

**快速访问**：
- 完整版：http://localhost:8001/frontend/smart-fortune.html
- 简化版：http://localhost:8001/frontend/intent-test.html

