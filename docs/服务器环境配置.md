# 服务器环境配置指南

## 安装 Git

### Ubuntu/Debian 系统：

```bash
# 更新软件包列表
sudo apt-get update

# 安装 Git
sudo apt-get install -y git

# 验证安装
git --version
```

### CentOS/RHEL 系统：

```bash
# 安装 Git
sudo yum install -y git

# 或者使用 dnf（CentOS 8+）
sudo dnf install -y git

# 验证安装
git --version
```

---

## 安装 Docker 和 Docker Compose

### Ubuntu/Debian 系统：

```bash
# 安装 Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# 将当前用户添加到 docker 组（避免每次都用 sudo）
sudo usermod -aG docker $USER

# 安装 Docker Compose
sudo apt-get install -y docker-compose-plugin

# 验证安装
docker --version
docker compose version

# 注意：需要重新登录才能使 docker 组权限生效
# 或者执行：newgrp docker
```

### CentOS/RHEL 系统：

```bash
# 安装 Docker
sudo yum install -y docker

# 启动 Docker
sudo systemctl start docker
sudo systemctl enable docker

# 将当前用户添加到 docker 组
sudo usermod -aG docker $USER

# 安装 Docker Compose
sudo yum install -y docker-compose-plugin

# 验证安装
docker --version
docker compose version

# 重新登录或执行：newgrp docker
```

---

## 一键安装所有依赖（推荐）

### Ubuntu/Debian：

```bash
# 更新系统
sudo apt-get update

# 安装 Git
sudo apt-get install -y git

# 安装 Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker $USER

# 安装 Docker Compose
sudo apt-get install -y docker-compose-plugin

# 验证安装
git --version
docker --version
docker compose version

# 重新登录或执行
newgrp docker
```

### CentOS/RHEL：

```bash
# 安装 Git
sudo yum install -y git

# 安装 Docker
sudo yum install -y docker
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER

# 安装 Docker Compose
sudo yum install -y docker-compose-plugin

# 验证安装
git --version
docker --version
docker compose version

# 重新登录或执行
newgrp docker
```

---

## 检查系统类型

如果不确定系统类型，执行：

```bash
# 查看系统信息
cat /etc/os-release

# 或者
lsb_release -a
```

---

## 安装完成后，继续部署

```bash
# 1. 创建目录并克隆代码
cd /opt
sudo mkdir -p HiFate-bazi
sudo chown $USER:$USER HiFate-bazi
cd HiFate-bazi
git clone https://github.com/zhoudengt/HiFate-bazi.git .

# 2. 配置环境变量
cp env.template .env
vim .env  # 修改密码和密钥
chmod 600 .env

# 3. 执行部署
chmod +x scripts/deploy_remote.sh
./scripts/deploy_remote.sh
```

