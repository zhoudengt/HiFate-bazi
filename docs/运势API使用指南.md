# è¿åŠ¿APIä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [åŠŸèƒ½æ¦‚è¿°](#1-åŠŸèƒ½æ¦‚è¿°)
2. [APIæ¥å£](#2-apiæ¥å£)
3. [é…ç½®è¯´æ˜](#3-é…ç½®è¯´æ˜)
4. [ä½¿ç”¨ç¤ºä¾‹](#4-ä½¿ç”¨ç¤ºä¾‹)
5. [æ”¯æŒçš„APIæä¾›å•†](#5-æ”¯æŒçš„apiæä¾›å•†)
6. [é”™è¯¯å¤„ç†](#6-é”™è¯¯å¤„ç†)

---

## 1. åŠŸèƒ½æ¦‚è¿°

è¿åŠ¿APIåŠŸèƒ½æä¾›**ä»Šæ—¥è¿åŠ¿**å’Œ**æœ¬æœˆè¿åŠ¿**æŸ¥è¯¢ï¼Œé€šè¿‡è°ƒç”¨ç¬¬ä¸‰æ–¹ç¨³å®šçš„è¿åŠ¿APIæ¥å£å®ç°ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **ä»Šæ—¥è¿åŠ¿**ï¼šè·å–æŒ‡å®šæ—¥æœŸçš„è¿åŠ¿ä¿¡æ¯
- âœ… **æœ¬æœˆè¿åŠ¿**ï¼šè·å–æŒ‡å®šæœˆä»½çš„è¿åŠ¿ä¿¡æ¯
- âœ… **å¤šæä¾›å•†æ”¯æŒ**ï¼šæ”¯æŒ3ä¸ªç¬¬ä¸‰æ–¹APIæä¾›å•†
- âœ… **è‡ªåŠ¨é€‰æ‹©**ï¼šè‡ªåŠ¨é€‰æ‹©å·²é…ç½®çš„APIæä¾›å•†
- âœ… **æ˜Ÿåº§è‡ªåŠ¨è®¡ç®—**ï¼šå¦‚æœä¸æä¾›æ˜Ÿåº§ï¼Œæ ¹æ®æ—¥æœŸè‡ªåŠ¨è®¡ç®—

### è¿åŠ¿å†…å®¹

- **æ•´ä½“è¿åŠ¿**ï¼šç»¼åˆè¿åŠ¿åˆ†æ
- **äº‹ä¸šè¿åŠ¿**ï¼šå·¥ä½œã€äº‹ä¸šå‘å±•
- **çˆ±æƒ…è¿åŠ¿**ï¼šæ„Ÿæƒ…ã€äººé™…å…³ç³»
- **è´¢è¿**ï¼šè´¢å¯Œã€æŠ•èµ„
- **å¥åº·è¿åŠ¿**ï¼šèº«ä½“å¥åº·
- **å¹¸è¿è‰²ã€å¹¸è¿æ•°å­—**ï¼šä»Šæ—¥è¿åŠ¿ç‰¹æœ‰

---

## 2. APIæ¥å£

### 2.1 è·å–ä»Šæ—¥è¿åŠ¿

**æ¥å£åœ°å€**: `POST /api/v1/fortune/daily`

**è¯·æ±‚å‚æ•°**:

```json
{
  "constellation": "ç™½ç¾Šåº§",  // å¯é€‰ï¼Œæ˜Ÿåº§åç§°ï¼ˆä¸­æ–‡ï¼‰
  "date": "2025-01-17",      // å¯é€‰ï¼Œæ—¥æœŸï¼Œé»˜è®¤ä¸ºä»Šå¤©
  "provider": "jisuapi"      // å¯é€‰ï¼ŒAPIæä¾›å•†
}
```

**å“åº”æ ¼å¼**:

```json
{
  "success": true,
  "provider": "jisuapi",
  "constellation": "ç™½ç¾Šåº§",
  "date": "2025-01-17",
  "fortune": {
    "overall": "æ•´ä½“è¿åŠ¿è¾ƒå¥½...",
    "career": "äº‹ä¸šè¿åŠ¿å¹³ç¨³...",
    "love": "æ„Ÿæƒ…è¿åŠ¿è‰¯å¥½...",
    "wealth": "è´¢è¿ä¸€èˆ¬...",
    "health": "å¥åº·è¿åŠ¿è‰¯å¥½...",
    "lucky_color": "çº¢è‰²",
    "lucky_number": "7",
    "lucky_direction": "ä¸œæ–¹"
  }
}
```

### 2.2 è·å–æœ¬æœˆè¿åŠ¿

**æ¥å£åœ°å€**: `POST /api/v1/fortune/monthly`

**è¯·æ±‚å‚æ•°**:

```json
{
  "constellation": "ç™½ç¾Šåº§",  // å¯é€‰ï¼Œæ˜Ÿåº§åç§°ï¼ˆä¸­æ–‡ï¼‰
  "year": 2025,              // å¯é€‰ï¼Œå¹´ä»½ï¼Œé»˜è®¤ä¸ºä»Šå¹´
  "month": 1,                // å¯é€‰ï¼Œæœˆä»½ï¼Œé»˜è®¤ä¸ºæœ¬æœˆ
  "provider": "jisuapi"      // å¯é€‰ï¼ŒAPIæä¾›å•†
}
```

**å“åº”æ ¼å¼**:

```json
{
  "success": true,
  "provider": "jisuapi",
  "constellation": "ç™½ç¾Šåº§",
  "year": 2025,
  "month": 1,
  "fortune": {
    "overall": "æœ¬æœˆæ•´ä½“è¿åŠ¿...",
    "career": "æœ¬æœˆäº‹ä¸šè¿åŠ¿...",
    "love": "æœ¬æœˆæ„Ÿæƒ…è¿åŠ¿...",
    "wealth": "æœ¬æœˆè´¢è¿...",
    "health": "æœ¬æœˆå¥åº·è¿åŠ¿..."
  }
}
```

### 2.3 è·å–å¯ç”¨çš„APIæä¾›å•†

**æ¥å£åœ°å€**: `GET /api/v1/fortune/providers`

**å“åº”æ ¼å¼**:

```json
{
  "success": true,
  "providers": [
    {
      "name": "jisuapi",
      "display_name": "æé€Ÿæ•°æ®",
      "configured": true,
      "api_key_env": "JISUAPI_KEY"
    },
    {
      "name": "tianapi",
      "display_name": "å¤©èšæ•°è¡Œ",
      "configured": false,
      "api_key_env": "TIANAPI_KEY"
    }
  ]
}
```

---

## 3. é…ç½®è¯´æ˜

### 3.1 ç¯å¢ƒå˜é‡é…ç½®

éœ€è¦åœ¨ç¯å¢ƒå˜é‡ä¸­é…ç½®APIå¯†é’¥ï¼ˆé€‰æ‹©å…¶ä¸­ä¸€ä¸ªå³å¯ï¼‰ï¼š

```bash
# æé€Ÿæ•°æ® API
export JISUAPI_KEY="your_jisuapi_key"

# æˆ– å¤©èšæ•°è¡Œ API
export TIANAPI_KEY="your_tianapi_key"

# æˆ– å…­æ´¾æ•°æ® API
export API6API_KEY="your_6api_key"
```

### 3.2 .env æ–‡ä»¶é…ç½®

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```bash
# è¿åŠ¿APIé…ç½®ï¼ˆé€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼‰
JISUAPI_KEY=your_jisuapi_key
# TIANAPI_KEY=your_tianapi_key
# API6API_KEY=your_6api_key
```

### 3.3 è·å–APIå¯†é’¥

#### æé€Ÿæ•°æ® (jisuapi)

1. è®¿é—®ï¼šhttps://www.jisuapi.com
2. æ³¨å†Œè´¦å·
3. åœ¨æ§åˆ¶å°è·å– API Key
4. å…è´¹ä¼šå‘˜æ¯å¤©å¯è°ƒç”¨ 100 æ¬¡

#### å¤©èšæ•°è¡Œ (tianapi)

1. è®¿é—®ï¼šhttps://www.tianapi.com
2. æ³¨å†Œè´¦å·
3. åœ¨æ§åˆ¶å°è·å– API Key
4. æ™®é€šä¼šå‘˜æ¯å¤©èµ é€ 100 æ¬¡è°ƒç”¨é¢åº¦

#### å…­æ´¾æ•°æ® (6api)

1. è®¿é—®ï¼šhttps://www.6api.net
2. æ³¨å†Œè´¦å·
3. åœ¨æ§åˆ¶å°è·å– API Key
4. å…è´¹ä¼šå‘˜æ¯å¤©å¯è°ƒç”¨ 100 æ¬¡

---

## 4. ä½¿ç”¨ç¤ºä¾‹

### 4.1 Shell è°ƒç”¨ç¤ºä¾‹

#### è·å–ä»Šæ—¥è¿åŠ¿

```bash
# åŸºç¡€è°ƒç”¨ï¼ˆä½¿ç”¨é»˜è®¤æ˜Ÿåº§å’Œæ—¥æœŸï¼‰
curl -X POST http://localhost:8001/api/v1/fortune/daily \
  -H "Content-Type: application/json" \
  -d '{}'

# æŒ‡å®šæ˜Ÿåº§
curl -X POST http://localhost:8001/api/v1/fortune/daily \
  -H "Content-Type: application/json" \
  -d '{
    "constellation": "ç™½ç¾Šåº§"
  }'

# æŒ‡å®šæ—¥æœŸ
curl -X POST http://localhost:8001/api/v1/fortune/daily \
  -H "Content-Type: application/json" \
  -d '{
    "date": "2025-01-17"
  }'
```

#### è·å–æœ¬æœˆè¿åŠ¿

```bash
# åŸºç¡€è°ƒç”¨ï¼ˆä½¿ç”¨é»˜è®¤æ˜Ÿåº§å’Œæœˆä»½ï¼‰
curl -X POST http://localhost:8001/api/v1/fortune/monthly \
  -H "Content-Type: application/json" \
  -d '{}'

# æŒ‡å®šæ˜Ÿåº§å’Œæœˆä»½
curl -X POST http://localhost:8001/api/v1/fortune/monthly \
  -H "Content-Type: application/json" \
  -d '{
    "constellation": "ç™½ç¾Šåº§",
    "year": 2025,
    "month": 1
  }'
```

### 4.2 Python è°ƒç”¨ç¤ºä¾‹

```python
import requests

# è·å–ä»Šæ—¥è¿åŠ¿
response = requests.post(
    'http://localhost:8001/api/v1/fortune/daily',
    json={
        'constellation': 'ç™½ç¾Šåº§',
        'date': '2025-01-17'
    }
)
result = response.json()

if result['success']:
    fortune = result['fortune']
    print(f"æ•´ä½“è¿åŠ¿: {fortune['overall']}")
    print(f"äº‹ä¸šè¿åŠ¿: {fortune['career']}")
    print(f"çˆ±æƒ…è¿åŠ¿: {fortune['love']}")
    print(f"è´¢è¿: {fortune['wealth']}")
    print(f"å¥åº·è¿åŠ¿: {fortune['health']}")
    print(f"å¹¸è¿è‰²: {fortune.get('lucky_color', '')}")
    print(f"å¹¸è¿æ•°å­—: {fortune.get('lucky_number', '')}")
else:
    print(f"è·å–å¤±è´¥: {result['error']}")
```

### 4.3 JavaScript è°ƒç”¨ç¤ºä¾‹

```javascript
// è·å–ä»Šæ—¥è¿åŠ¿
async function getDailyFortune(constellation = null, date = null) {
  const response = await fetch('http://localhost:8001/api/v1/fortune/daily', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      constellation: constellation,
      date: date
    })
  });
  
  const result = await response.json();
  
  if (result.success) {
    console.log('æ•´ä½“è¿åŠ¿:', result.fortune.overall);
    console.log('äº‹ä¸šè¿åŠ¿:', result.fortune.career);
    console.log('çˆ±æƒ…è¿åŠ¿:', result.fortune.love);
    console.log('è´¢è¿:', result.fortune.wealth);
    console.log('å¥åº·è¿åŠ¿:', result.fortune.health);
  } else {
    console.error('è·å–å¤±è´¥:', result.error);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
getDailyFortune('ç™½ç¾Šåº§', '2025-01-17');
```

---

## 5. æ”¯æŒçš„APIæä¾›å•†

### 5.1 æé€Ÿæ•°æ® (jisuapi)

- **åç§°**: æé€Ÿæ•°æ®
- **ç¯å¢ƒå˜é‡**: `JISUAPI_KEY`
- **å…è´¹é¢åº¦**: æ¯å¤© 100 æ¬¡
- **ä»˜è´¹é¢åº¦**: ç™½é“¶ä¼šå‘˜ 600 æ¬¡/å¤©ï¼Œé’»çŸ³ä¼šå‘˜ 15 ä¸‡æ¬¡/å¤©
- **å®˜ç½‘**: https://www.jisuapi.com

### 5.2 å¤©èšæ•°è¡Œ (tianapi)

- **åç§°**: å¤©èšæ•°è¡Œ
- **ç¯å¢ƒå˜é‡**: `TIANAPI_KEY`
- **å…è´¹é¢åº¦**: æ¯å¤© 100 æ¬¡
- **ä»˜è´¹é¢åº¦**: é«˜çº§ä¼šå‘˜ 1 ä¸‡æ¬¡/å¤©ï¼Œé»„é‡‘ä¼šå‘˜ 50 ä¸‡æ¬¡/å¤©
- **å®˜ç½‘**: https://www.tianapi.com

### 5.3 å…­æ´¾æ•°æ® (6api)

- **åç§°**: å…­æ´¾æ•°æ®
- **ç¯å¢ƒå˜é‡**: `API6API_KEY`
- **å…è´¹é¢åº¦**: æ¯å¤© 100 æ¬¡
- **ä»˜è´¹é¢åº¦**: ç™½é“¶ä¼šå‘˜ 600 æ¬¡/å¤©ï¼Œé’»çŸ³ä¼šå‘˜ 15 ä¸‡æ¬¡/å¤©
- **å®˜ç½‘**: https://www.6api.net

### 5.4 è‡ªåŠ¨é€‰æ‹©æœºåˆ¶

ç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©å·²é…ç½®APIå¯†é’¥çš„æä¾›å•†ï¼š
1. ä¼˜å…ˆé€‰æ‹©å·²é…ç½®çš„æä¾›å•†
2. å¦‚æœå¤šä¸ªæä¾›å•†éƒ½å·²é…ç½®ï¼ŒæŒ‰é¡ºåºé€‰æ‹©ç¬¬ä¸€ä¸ª
3. å¦‚æœæ²¡æœ‰é…ç½®ä»»ä½•æä¾›å•†ï¼Œè¿”å›é”™è¯¯æç¤º

---

## 6. é”™è¯¯å¤„ç†

### 6.1 å¸¸è§é”™è¯¯

| é”™è¯¯ç±»å‹ | HTTPçŠ¶æ€ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|---------|-----------|------|---------|
| **æœªé…ç½®APIå¯†é’¥** | 200 | success=false, erroråŒ…å«é”™è¯¯ä¿¡æ¯ | é…ç½®ç¯å¢ƒå˜é‡ |
| **APIè°ƒç”¨å¤±è´¥** | 200 | success=false, erroråŒ…å«é”™è¯¯ä¿¡æ¯ | æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡® |
| **å‚æ•°éªŒè¯å¤±è´¥** | 400 | HTTPException | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼ |
| **æœåŠ¡å™¨é”™è¯¯** | 500 | HTTPException | æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿— |

### 6.2 é”™è¯¯å“åº”ç¤ºä¾‹

```json
{
  "success": false,
  "error": "æœªé…ç½® æé€Ÿæ•°æ® APIå¯†é’¥ï¼Œè¯·åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½® JISUAPI_KEY"
}
```

### 6.3 é”™è¯¯å¤„ç†å»ºè®®

1. **æ£€æŸ¥APIå¯†é’¥é…ç½®**
   ```bash
   # æ£€æŸ¥ç¯å¢ƒå˜é‡
   echo $JISUAPI_KEY
   ```

2. **æŸ¥çœ‹APIæä¾›å•†çŠ¶æ€**
   ```bash
   curl http://localhost:8001/api/v1/fortune/providers
   ```

3. **æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—**
   ```bash
   tail -f logs/web_app_8001.log
   ```

---

## 7. æ³¨æ„äº‹é¡¹

### 7.1 APIè°ƒç”¨é™åˆ¶

- **å…è´¹é¢åº¦æœ‰é™**ï¼šå…è´¹ä¼šå‘˜æ¯å¤©åªæœ‰ 100 æ¬¡è°ƒç”¨
- **å»ºè®®æ·»åŠ ç¼“å­˜**ï¼šç›¸åŒæ˜Ÿåº§å’Œæ—¥æœŸçš„è¿åŠ¿å¯ä»¥ç¼“å­˜
- **ç›‘æ§è°ƒç”¨é‡**ï¼šé¿å…è¶…å‡ºå…è´¹é¢åº¦

### 7.2 æ˜Ÿåº§è®¡ç®—

- å¦‚æœä¸æä¾›æ˜Ÿåº§ï¼Œç³»ç»Ÿä¼šæ ¹æ®æ—¥æœŸè‡ªåŠ¨è®¡ç®—
- æ˜Ÿåº§è®¡ç®—åŸºäºé˜³å†æ—¥æœŸ
- å»ºè®®æ˜ç¡®æŒ‡å®šæ˜Ÿåº§ä»¥è·å¾—æ›´å‡†ç¡®çš„ç»“æœ

### 7.3 ç”Ÿäº§ç¯å¢ƒå»ºè®®

1. **é…ç½®å¤šä¸ªAPIæä¾›å•†**ï¼šä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
2. **æ·»åŠ ç¼“å­˜æœºåˆ¶**ï¼šå‡å°‘APIè°ƒç”¨æ¬¡æ•°
3. **ç›‘æ§APIè°ƒç”¨**ï¼šè·Ÿè¸ªè°ƒç”¨é‡å’Œé”™è¯¯ç‡
4. **è®¾ç½®å‘Šè­¦**ï¼šAPIè°ƒç”¨å¤±è´¥æ—¶å‘Šè­¦

---

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-01-XX  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ

