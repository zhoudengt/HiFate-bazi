# ç”¨æˆ·æƒé™è¯´æ˜ - Docker éƒ¨ç½²

## ğŸ“‹ ç”¨æˆ·æƒé™è¦æ±‚

### âœ… æ¨èï¼šä½¿ç”¨ root ç”¨æˆ·ï¼ˆæœ€ç®€å•ï¼‰

**ä¼˜ç‚¹**ï¼š
- ä¸éœ€è¦é…ç½® sudo æƒé™
- ä¸éœ€è¦å¤„ç†æ–‡ä»¶æƒé™é—®é¢˜
- éƒ¨ç½²è¿‡ç¨‹æœ€ç®€å•

**æ“ä½œæ­¥éª¤**ï¼š

```bash
# 1. ä½¿ç”¨ root ç”¨æˆ·ç™»å½•æœåŠ¡å™¨
ssh root@æœåŠ¡å™¨IP

# 2. ç›´æ¥æ‰§è¡Œéƒ¨ç½²å‘½ä»¤
cd /opt
mkdir -p HiFate-bazi
cd HiFate-bazi
git clone https://github.com/zhoudengt/HiFate-bazi.git .
chmod +x scripts/deploy_remote.sh
./scripts/deploy_remote.sh
```

---

### âœ… å¯é€‰ï¼šä½¿ç”¨æ™®é€šç”¨æˆ·ï¼ˆæ›´å®‰å…¨ï¼‰

**ä¼˜ç‚¹**ï¼š
- æ›´å®‰å…¨ï¼ˆéµå¾ªæœ€å°æƒé™åŸåˆ™ï¼‰
- ç¬¦åˆç”Ÿäº§ç¯å¢ƒæœ€ä½³å®è·µ

**å‰ææ¡ä»¶**ï¼š
- ç”¨æˆ·éœ€è¦æœ‰ sudo æƒé™
- ç”¨æˆ·éœ€è¦èƒ½æ‰§è¡Œ Docker å‘½ä»¤

**æ“ä½œæ­¥éª¤**ï¼š

```bash
# 1. ä½¿ç”¨æ™®é€šç”¨æˆ·ç™»å½•æœåŠ¡å™¨
ssh ubuntu@æœåŠ¡å™¨IP  # æˆ– ssh user@æœåŠ¡å™¨IP

# 2. ç¡®ä¿ç”¨æˆ·æœ‰ sudo æƒé™
sudo -v  # æµ‹è¯• sudo æƒé™

# 3. å°†ç”¨æˆ·æ·»åŠ åˆ° docker ç»„ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
sudo usermod -aG docker $USER
# é‡æ–°ç™»å½•æˆ–æ‰§è¡Œï¼šnewgrp docker

# 4. æ‰§è¡Œéƒ¨ç½²å‘½ä»¤
cd /opt
sudo mkdir -p HiFate-bazi
sudo chown $USER:$USER HiFate-bazi
cd HiFate-bazi
git clone https://github.com/zhoudengt/HiFate-bazi.git .
chmod +x scripts/deploy_remote.sh
./scripts/deploy_remote.sh
```

---

## ğŸ¯ ç”¨æˆ·æƒé™å¯¹æ¯”

| æ“ä½œ | root ç”¨æˆ· | æ™®é€šç”¨æˆ·ï¼ˆæœ‰ sudoï¼‰ |
|------|-----------|---------------------|
| **ç™»å½•æœåŠ¡å™¨** | `ssh root@IP` | `ssh user@IP` |
| **åˆ›å»ºç›®å½•** | `mkdir -p /opt/HiFate-bazi` | `sudo mkdir -p /opt/HiFate-bazi` |
| **å…‹éš†ä»£ç ** | `git clone ...` | `git clone ...` |
| **æ‰§è¡Œ Docker** | `docker ...` | `docker ...`ï¼ˆéœ€è¦åœ¨ docker ç»„ï¼‰ |
| **æ‰§è¡Œè„šæœ¬** | `./scripts/deploy_remote.sh` | `./scripts/deploy_remote.sh` |

---

## ğŸ“ è¯¦ç»†è¯´æ˜

### 1. ç™»å½•æœåŠ¡å™¨

**root ç”¨æˆ·**ï¼š
```bash
ssh root@æœåŠ¡å™¨IP
# è¾“å…¥ root å¯†ç 
```

**æ™®é€šç”¨æˆ·**ï¼š
```bash
ssh ubuntu@æœåŠ¡å™¨IP  # Ubuntu ç³»ç»Ÿ
# æˆ–
ssh user@æœåŠ¡å™¨IP    # å…¶ä»–ç³»ç»Ÿ
# è¾“å…¥ç”¨æˆ·å¯†ç 
```

---

### 2. åˆ›å»ºé¡¹ç›®ç›®å½•

**root ç”¨æˆ·**ï¼š
```bash
mkdir -p /opt/HiFate-bazi
cd /opt/HiFate-bazi
```

**æ™®é€šç”¨æˆ·**ï¼š
```bash
sudo mkdir -p /opt/HiFate-bazi
sudo chown $USER:$USER /opt/HiFate-bazi
cd /opt/HiFate-bazi
```

---

### 3. å…‹éš†ä»£ç 

**ä¸¤ç§ç”¨æˆ·éƒ½ä¸€æ ·**ï¼š
```bash
git clone https://github.com/zhoudengt/HiFate-bazi.git .
```

---

### 4. æ‰§è¡Œéƒ¨ç½²è„šæœ¬

**ä¸¤ç§ç”¨æˆ·éƒ½ä¸€æ ·**ï¼š
```bash
chmod +x scripts/deploy_remote.sh
./scripts/deploy_remote.sh
```

**è„šæœ¬ä¼šè‡ªåŠ¨å¤„ç†**ï¼š
- root ç”¨æˆ·ï¼šä¸ä½¿ç”¨ sudo
- æ™®é€šç”¨æˆ·ï¼šè‡ªåŠ¨ä½¿ç”¨ sudoï¼ˆå¦‚æœéœ€è¦ï¼‰

---

## ğŸ”’ å®‰å…¨å»ºè®®

### ç”Ÿäº§ç¯å¢ƒæ¨èé…ç½®

1. **ä½¿ç”¨æ™®é€šç”¨æˆ· + sudo**ï¼š
   ```bash
   # åˆ›å»ºä¸“ç”¨éƒ¨ç½²ç”¨æˆ·
   sudo useradd -m -s /bin/bash deploy
   sudo usermod -aG docker deploy
   sudo usermod -aG sudo deploy
   
   # ä½¿ç”¨è¯¥ç”¨æˆ·éƒ¨ç½²
   su - deploy
   ```

2. **é™åˆ¶ sudo æƒé™**ï¼ˆå¯é€‰ï¼‰ï¼š
   ```bash
   # ç¼–è¾‘ sudoers
   sudo visudo
   
   # æ·»åŠ ï¼ˆå…è®¸ deploy ç”¨æˆ·æ‰§è¡Œç‰¹å®šå‘½ä»¤ï¼‰
   deploy ALL=(ALL) NOPASSWD: /usr/bin/docker, /usr/bin/docker-compose
   ```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆè„šæœ¬ä¸å…è®¸ root ç”¨æˆ·ï¼Ÿ

**A**: ä¹‹å‰çš„ç‰ˆæœ¬ä¸å…è®¸ rootï¼Œç°åœ¨å·²ç»ä¿®æ”¹ä¸º**å…è®¸ root ç”¨æˆ·**ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨ root ç”¨æˆ·éƒ¨ç½²ã€‚

### Q2: root ç”¨æˆ·å’Œæ™®é€šç”¨æˆ·æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**A**: 
- **root ç”¨æˆ·**ï¼šæ‹¥æœ‰æ‰€æœ‰æƒé™ï¼Œä¸éœ€è¦ sudoï¼Œéƒ¨ç½²æœ€ç®€å•
- **æ™®é€šç”¨æˆ·**ï¼šéœ€è¦ sudo æƒé™ï¼Œæ›´å®‰å…¨ï¼Œä½†é…ç½®ç¨å¤æ‚

### Q3: æˆ‘åº”è¯¥ç”¨å“ªä¸ªç”¨æˆ·ï¼Ÿ

**A**: 
- **å¿«é€Ÿéƒ¨ç½²**ï¼šä½¿ç”¨ root ç”¨æˆ·ï¼ˆæœ€ç®€å•ï¼‰
- **ç”Ÿäº§ç¯å¢ƒ**ï¼šä½¿ç”¨æ™®é€šç”¨æˆ· + sudoï¼ˆæ›´å®‰å…¨ï¼‰

### Q4: å¦‚ä½•æ£€æŸ¥å½“å‰ç”¨æˆ·ï¼Ÿ

**A**: 
```bash
# æŸ¥çœ‹å½“å‰ç”¨æˆ·
whoami

# æŸ¥çœ‹ç”¨æˆ· IDï¼ˆroot æ˜¯ 0ï¼‰
id -u

# æ£€æŸ¥æ˜¯å¦æœ‰ sudo æƒé™
sudo -v
```

---

## âœ… æ€»ç»“

### æœ€ç®€å•çš„æ–¹å¼ï¼ˆæ¨èé¦–æ¬¡éƒ¨ç½²ï¼‰ï¼š

```bash
# 1. ä½¿ç”¨ root ç”¨æˆ·ç™»å½•
ssh root@æœåŠ¡å™¨IP

# 2. æ‰§è¡Œéƒ¨ç½²
cd /opt
mkdir -p HiFate-bazi
cd HiFate-bazi
git clone https://github.com/zhoudengt/HiFate-bazi.git .
chmod +x scripts/deploy_remote.sh
./scripts/deploy_remote.sh
```

**å°±è¿™ä¹ˆç®€å•ï¼** è„šæœ¬å·²ç»æ”¯æŒ root ç”¨æˆ·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚

