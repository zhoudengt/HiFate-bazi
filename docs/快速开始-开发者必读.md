# å¿«é€Ÿå¼€å§‹ - å¼€å‘è€…å¿…è¯»

> HiFate-bazi å…«å­—ç³»ç»Ÿå¼€å‘æŒ‡å— - 3åˆ†é’Ÿä¸Šæ‰‹

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ–¹å¼ 1ï¼šæœ¬åœ°ç›´æ¥å¼€å‘ï¼ˆä¼ ç»Ÿæ–¹å¼ï¼‰

```bash
# 1. å¯åŠ¨æœåŠ¡
./start_all_services.sh

# 2. è®¿é—®
open http://localhost:8001/frontend/formula-analysis.html

# 3. ä¿®æ”¹ä»£ç 
vim server/api/v1/bazi.py

# 4. é‡å¯æœåŠ¡
./restart_server.sh
```

### æ–¹å¼ 2ï¼šDocker å¼€å‘ï¼ˆæ¨èï¼Œæ”¯æŒçƒ­æ›´æ–°ï¼‰

```bash
# 1. å¯åŠ¨ Docker å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# 2. è®¿é—®
open http://localhost:8001/frontend/formula-analysis.html

# 3. ä¿®æ”¹ä»£ç ï¼ˆè‡ªåŠ¨é‡è½½ï¼Œæ— éœ€é‡å¯ï¼ï¼‰
vim server/api/v1/bazi.py

# å°±è¿™ä¹ˆç®€å•ï¼âœ¨
```

---

## ğŸ“‹ å¼€å‘æµç¨‹

### 1. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯

```bash
# ä» develop åˆ›å»ºæ–°åŠŸèƒ½åˆ†æ”¯
git checkout develop
git pull origin develop
git checkout -b feature/æˆ‘çš„æ–°åŠŸèƒ½
```

### 2. æœ¬åœ°å¼€å‘å’Œæµ‹è¯•

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# ä¿®æ”¹ä»£ç ...
# æµ‹è¯•åŠŸèƒ½...
```

### 3. æäº¤ä»£ç ï¼ˆä½¿ç”¨æäº¤åŠ©æ‰‹ï¼‰

```bash
# æ–¹å¼ Aï¼šä½¿ç”¨æäº¤åŠ©æ‰‹ï¼ˆæ¨èï¼‰
./scripts/commit-helper.sh

# æ–¹å¼ Bï¼šæ‰‹åŠ¨æäº¤
git add .
git commit -m "[æ–°å¢] åŠŸèƒ½æè¿°

- ä¿®æ”¹æ–‡ä»¶ï¼šåˆ—å‡ºæ–‡ä»¶
- åŠŸèƒ½è¯´æ˜ï¼šè¯¦ç»†è¯´æ˜
- æµ‹è¯•æƒ…å†µï¼šå·²é€šè¿‡æœ¬åœ°æµ‹è¯•"

git push origin feature/æˆ‘çš„æ–°åŠŸèƒ½
```

### 4. åˆå¹¶åˆ° developï¼ˆå¼€å‘ç¯å¢ƒï¼‰

```bash
git checkout develop
git merge feature/æˆ‘çš„æ–°åŠŸèƒ½
git push origin develop
# ğŸš€ è‡ªåŠ¨éƒ¨ç½²åˆ°å¼€å‘æœåŠ¡å™¨ï¼
```

### 5. å‘å¸ƒåˆ°ç”Ÿäº§

```bash
# å¼€å‘ç¯å¢ƒæµ‹è¯•é€šè¿‡å
git checkout master
git merge develop
git push origin master
# ğŸš€ è‡ªåŠ¨éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨ï¼
```

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

### æœåŠ¡ç®¡ç†

```bash
# Docker æ–¹å¼
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up      # å¯åŠ¨
docker-compose -f docker-compose.yml -f docker-compose.dev.yml down    # åœæ­¢
docker-compose logs -f web                                              # æŸ¥çœ‹æ—¥å¿—
docker-compose restart web                                              # é‡å¯æœåŠ¡

# ä¼ ç»Ÿæ–¹å¼
./start_all_services.sh     # å¯åŠ¨æ‰€æœ‰æœåŠ¡
./stop_all_services.sh      # åœæ­¢æ‰€æœ‰æœåŠ¡
./restart_server.sh         # é‡å¯ä¸»æœåŠ¡
./check_services.sh         # æ£€æŸ¥æœåŠ¡çŠ¶æ€
```

### Git æ“ä½œ

```bash
git status                              # æŸ¥çœ‹çŠ¶æ€
git diff                                # æŸ¥çœ‹ä¿®æ”¹
git log --oneline -10                   # æŸ¥çœ‹æäº¤å†å²
git checkout -b feature/new-feature    # åˆ›å»ºæ–°åˆ†æ”¯
git branch -a                          # æŸ¥çœ‹æ‰€æœ‰åˆ†æ”¯
```

### æäº¤å‰æ£€æŸ¥

```bash
./scripts/pre-commit-check.sh          # è¿è¡Œæäº¤å‰æ£€æŸ¥
./scripts/commit-helper.sh             # ä½¿ç”¨æäº¤åŠ©æ‰‹
```

---

## ğŸ“š é‡è¦æ–‡æ¡£

| æ–‡æ¡£ | è¯´æ˜ | è·¯å¾„ |
|------|------|------|
| **å¼€å‘è§„èŒƒ** | AI åŠ©æ‰‹éµå¾ªçš„è§„èŒƒ | `.cursorrules` |
| **Git Flow** | åˆ†æ”¯ç®¡ç†å’Œå‘å¸ƒæµç¨‹ | `docs/Git-Flowå·¥ä½œæµç¨‹.md` |
| **Docker éƒ¨ç½²** | è‡ªåŠ¨åŒ–éƒ¨ç½²æ–¹æ¡ˆ | `docs/éƒ¨ç½²æ–¹æ¡ˆ5-Dockerè‡ªåŠ¨åŒ–éƒ¨ç½².md` |
| **API æ–‡æ¡£** | æ¥å£è¯´æ˜ | `docs/bazi_api_structure.json` |
| **è§„åˆ™ç³»ç»Ÿ** | è§„åˆ™å¼•æ“æ¶æ„ | `docs/rule_system_architecture.md` |

---

## ğŸ¯ å·¥ä½œæµæ€»ç»“

```
æœ¬åœ°å¼€å‘ï¼ˆDockerçƒ­æ›´æ–°ï¼‰
  â”œâ”€â”€ ä¿®æ”¹ä»£ç  â†’ è‡ªåŠ¨é‡è½½
  â”œâ”€â”€ æœ¬åœ°æµ‹è¯• â†’ http://localhost:8001
  â””â”€â”€ æäº¤ä»£ç  â†’ git push origin feature/xxx
       â†“
åˆå¹¶åˆ° develop
  â”œâ”€â”€ git merge feature/xxx
  â””â”€â”€ git push origin develop
       â†“ è‡ªåŠ¨éƒ¨ç½²
       â””â”€â”€ å¼€å‘æœåŠ¡å™¨ (dev.hifate.com)
            â†“ æµ‹è¯•é€šè¿‡
            â””â”€â”€ åˆå¹¶åˆ° master
                 â”œâ”€â”€ git merge develop
                 â””â”€â”€ git push origin master
                      â†“ è‡ªåŠ¨éƒ¨ç½²
                      â””â”€â”€ ç”Ÿäº§æœåŠ¡å™¨ (hifate.com)
```

---

## âš ï¸ é‡è¦æé†’

### âœ… å¿…é¡»éµå®ˆ

1. **ä¸è¦ç›´æ¥åœ¨ master å¼€å‘**
2. **åŠŸèƒ½å®Œæˆåå¿…é¡»æœ¬åœ°æµ‹è¯•**
3. **æäº¤å‰è¿è¡Œ `./scripts/pre-commit-check.sh`**
4. **æäº¤ä¿¡æ¯ä½¿ç”¨è§„èŒƒæ ¼å¼**
5. **develop æµ‹è¯•é€šè¿‡åæ‰èƒ½åˆå¹¶åˆ° master**

### âŒ ä¸è¦æäº¤

- `logs/*.log` - æ—¥å¿—æ–‡ä»¶
- `*.pyc`, `__pycache__/` - Python ç¼“å­˜
- `config/*.env` - æ•æ„Ÿé…ç½®
- `.DS_Store` - macOS ç³»ç»Ÿæ–‡ä»¶
- `*.pid` - è¿›ç¨‹æ–‡ä»¶

### ğŸ”’ æ•æ„Ÿä¿¡æ¯

- æ•°æ®åº“å¯†ç åœ¨ `config/services.env`
- GitHub Secrets ä¸­çš„ SSH ç§é’¥
- ç¬¬ä¸‰æ–¹ API å¯†é’¥

**è¿™äº›ä¸è¦æäº¤åˆ° Gitï¼**

---

## ğŸ› å¸¸è§é—®é¢˜

### 1. Docker å®¹å™¨å¯åŠ¨å¤±è´¥

```bash
# æŸ¥çœ‹æ—¥å¿—
docker-compose logs

# æ¸…ç†å¹¶é‡å¯
docker-compose down
docker system prune -a
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up
```

### 2. çƒ­æ›´æ–°ä¸å·¥ä½œ

```bash
# ç¡®è®¤ä½¿ç”¨å¼€å‘é…ç½®
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# é‡å¯å®¹å™¨
docker-compose restart web
```

### 3. ç«¯å£è¢«å ç”¨

```bash
# æŸ¥çœ‹å ç”¨ç«¯å£çš„è¿›ç¨‹
lsof -i :8001
lsof -i :13306

# åœæ­¢æ—§æœåŠ¡
./stop_all_services.sh
docker-compose down
```

### 4. Git åˆå¹¶å†²çª

```bash
# 1. å°è¯•åˆå¹¶
git merge develop
# æç¤ºå†²çª

# 2. æŸ¥çœ‹å†²çªæ–‡ä»¶
git status

# 3. ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œè§£å†³å†²çª
vim conflicted_file.py

# 4. æ ‡è®°ä¸ºå·²è§£å†³
git add conflicted_file.py

# 5. å®Œæˆåˆå¹¶
git commit -m "[åˆå¹¶] è§£å†³å†²çª"
```

---

## ğŸ“ è·å–å¸®åŠ©

### æŸ¥çœ‹æ–‡æ¡£

```bash
# å¼€å‘è§„èŒƒ
cat .cursorrules

# Git Flow
cat docs/Git-Flowå·¥ä½œæµç¨‹.md

# Docker éƒ¨ç½²
cat docs/éƒ¨ç½²æ–¹æ¡ˆ5-Dockerè‡ªåŠ¨åŒ–éƒ¨ç½².md
```

### å’¨è¯¢ AI åŠ©æ‰‹

```
"Docker å®¹å™¨å¯åŠ¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ"
"å¦‚ä½•åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ï¼Ÿ"
"æäº¤ä»£ç çš„æ­£ç¡®æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ"
```

### GitHub Actions

æŸ¥çœ‹éƒ¨ç½²è¿›åº¦ï¼š
```
https://github.com/zhoudengt/HiFate-bazi/actions
```

---

## ğŸ‰ å¼€å§‹å¼€å‘å§ï¼

```bash
# 1. å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up

# 2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/æˆ‘çš„åŠŸèƒ½

# 3. å¼€å§‹ç¼–ç ï¼
vim server/api/v1/my_feature.py

# 4. æµ‹è¯•
open http://localhost:8001

# 5. æäº¤
./scripts/commit-helper.sh

# å®Œæˆï¼ğŸš€
```

---

**è®°ä½ä¸‰ä¸ªåŸåˆ™**ï¼š
1. ğŸ”’ **æœ€å°å½±å“**ï¼šåªæ”¹å¿…è¦çš„ä»£ç 
2. ğŸ§ª **æµ‹è¯•ä¼˜å…ˆ**ï¼šæäº¤å‰å¿…é¡»æµ‹è¯•
3. ğŸ“ **è§„èŒƒæäº¤**ï¼šæ¸…æ™°çš„æäº¤ä¿¡æ¯

**ç¥å¼€å‘æ„‰å¿«ï¼** âœ¨

