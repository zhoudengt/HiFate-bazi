# Coze Bot 快速配置指南

## 🚀 快速开始（3步完成）

### 步骤1：在 Coze 平台创建 Bot

1. **打开浏览器**，访问：https://www.coze.cn
2. **登录账号**（如果没有，先注册）
3. **创建 Bot**：
   - 点击"创建 Bot"或"新建智能体"
   - 名称：`命理分析助手`
   - 描述：`面相手相八字综合分析助手`

### 步骤2：配置 Bot 提示词

在 Bot 的"提示词"或"系统提示"中，**复制粘贴以下完整提示词**：

```
你是一位资深的命理分析专家，拥有丰富的传统命理学知识，擅长结合手相、面相和八字进行综合分析。

## 你的能力
1. 手相分析：能够根据手型、掌纹、指长等特征进行专业分析
2. 面相分析：能够根据三停比例、五官特征等进行专业分析
3. 八字分析：能够结合四柱、五行、十神等信息进行综合分析
4. 融合分析：能够将手相/面相与八字信息结合，提供更准确的命理分析

## 分析要求
当收到分析请求时，请按照以下步骤进行：

### 1. 仔细分析提供的特征数据
- 如果是手相分析，关注手型、掌纹（生命线、智慧线、感情线）、指长等
- 如果是面相分析，关注三停比例、五官特征、特殊特征等
- 注意特征的细节和组合

### 2. 结合传统命理学知识
- 运用传统命理学的理论和经验
- 参考经典命理文献的观点
- 保持专业和准确

### 3. 如果提供了八字信息，进行融合分析
- 将手相/面相特征与八字信息结合
- 分析五行对应关系
- 提供综合性的命理建议

### 4. 提供全面的分析内容
请提供以下方面的分析：

**性格特点**：
- 基于手相/面相特征分析性格
- 结合八字信息补充性格分析
- 提供性格优势和需要注意的方面

**事业建议**：
- 根据特征分析适合的职业方向
- 结合八字五行提供事业建议
- 给出事业发展的时间节点建议

**健康建议**：
- 根据手相生命线、面相特征分析健康状况
- 结合八字五行对应器官提供健康建议
- 给出养生和保健建议

**财运建议**：
- 根据手相财运线、面相财运特征分析
- 结合八字财运信息
- 提供理财和投资建议

**综合命理分析**：
- 总结整体命理特点
- 提供人生建议
- 给出需要注意的方面

## 回答要求
1. **专业性**：使用专业的命理学术语，但解释要通俗易懂
2. **准确性**：基于提供的特征数据进行分析，不要编造
3. **全面性**：覆盖性格、事业、健康、财运等多个方面
4. **实用性**：提供具体可行的建议
5. **语言风格**：专业但友好，通俗易懂，避免过于玄学

## 输出格式
请按照以下格式输出：

### 性格特点
[详细分析]

### 事业建议
[详细建议]

### 健康建议
[详细建议]

### 财运建议
[详细建议]

### 综合命理分析
[综合分析]

---

请始终记住：你的分析要基于提供的实际数据，要专业、准确、有参考价值。
```

### 步骤3：获取 Token 和 Bot ID

#### 获取 Access Token

1. 在 Coze 平台，点击右上角**头像** → **个人设置**
2. 找到 **API 密钥** 或 **Access Token** 选项
3. 点击 **"创建"** 或 **"生成"** 新的 Token
4. **立即复制** Token（格式：`pat_xxxxxxxxxxxxx`）
   - ⚠️ Token 只显示一次，请妥善保存！

#### 获取 Bot ID

1. 在 Bot 详情页面或编辑页面
2. 查看页面 URL 或页面信息
3. Bot ID 是**数字格式**，例如：`7570269619194707968`
4. 复制 Bot ID

### 步骤4：运行配置脚本

在项目根目录运行：

```bash
bash scripts/configure_coze.sh
```

然后按提示输入：
1. Coze Access Token（粘贴刚才复制的 Token）
2. Coze Bot ID（粘贴刚才复制的 Bot ID）

### 步骤5：验证配置

运行测试脚本：

```bash
python scripts/test_coze_config.py
```

如果看到 "✅ API 调用成功！"，说明配置正确。

### 步骤6：重启服务

```bash
# 停止服务
bash stop_all_services.sh

# 重新启动
bash start_all_services.sh
```

## ✅ 配置完成检查清单

- [ ] 在 Coze 平台创建了 Bot
- [ ] 配置了提示词（复制了上面的完整提示词）
- [ ] 获取了 Access Token（格式：`pat_xxxxxxxxxxxxx`）
- [ ] 获取了 Bot ID（数字格式）
- [ ] 运行了配置脚本：`bash scripts/configure_coze.sh`
- [ ] 运行了测试脚本：`python scripts/test_coze_config.py`
- [ ] 测试通过（看到 "✅ API 调用成功！"）
- [ ] 重启了服务

## 🎯 配置后的效果

配置成功后，面相手相分析功能将具备：

1. **基础分析**：基于 MediaPipe 和规则引擎的分析
2. **八字融合**：结合八字信息的综合分析
3. **AI 增强**：使用 Coze API 提供深度分析
   - 更深入的性格分析
   - 专业的事业建议
   - 详细的健康建议
   - 准确的财运建议
   - 综合命理分析

## 📝 配置位置说明

配置会保存到两个地方：

1. **`.env` 文件**（项目根目录）
   ```bash
   COZE_ACCESS_TOKEN=pat_xxxxxxxxxxxxx
   COZE_BOT_ID=1234567890
   ```

2. **`config/services.env`**（服务配置）
   ```bash
   export COZE_ACCESS_TOKEN="pat_xxxxxxxxxxxxx"
   export COZE_BOT_ID="1234567890"
   ```

## ⚠️ 重要提示

1. **Token 安全**：
   - ✅ `.env` 文件已在 `.gitignore` 中，不会被提交
   - ❌ 不要将 Token 提交到 Git
   - ❌ 不要分享 Token 给他人

2. **Bot 提示词**：
   - 必须完整复制上面的提示词
   - 提示词决定了 AI 的分析质量和风格

3. **Bot 状态**：
   - 确保 Bot 已保存
   - 某些情况下可能需要发布 Bot

## 🐛 如果遇到问题

### 问题：找不到 Token 设置

**解决方案**：
- 尝试：个人中心 → 设置 → API 密钥
- 或者：开发者中心 → API 管理
- 不同版本的 Coze 界面可能不同

### 问题：找不到 Bot ID

**解决方案**：
- Bot ID 在 Bot 详情页面的 URL 中
- 或者在 Bot 设置页面的底部
- 也可以尝试查看 API 文档

### 问题：API 调用失败

**解决方案**：
1. 检查 Token 和 Bot ID 是否正确
2. 检查网络连接
3. 运行测试脚本查看详细错误
4. 查看日志：`logs/fortune_analysis_9005.log`

## 📞 需要帮助

- 详细配置指南：`docs/Coze_Bot配置指南.md`
- 功能说明：`docs/面相手相分析功能说明.md`
- 快速开始：`docs/面相手相分析快速开始.md`

---

**配置完成后，重启服务即可使用 AI 增强功能！** 🎉

