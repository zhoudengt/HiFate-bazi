# HiFate前端 Demo

## 📋 项目说明

这是一个前后端分离的前端 Demo 项目，用于测试HiFate系统的各项功能。

## 🚀 快速开始

### 1. 启动后端服务

```bash
cd /Users/zhoudt/Downloads/project/HiFate-bazi
python server/start.py
```

后端服务将在 `http://127.0.0.1:8001` 启动。

### 2. 打开前端页面

**方式 1：直接打开（推荐）**

直接在浏览器中打开 `frontend/index.html` 文件。

**方式 2：使用本地服务器（推荐，避免 CORS 问题）**

```bash
# 使用 Python 启动简单 HTTP 服务器
cd frontend
python3 -m http.server 8080
```

然后在浏览器中访问：`http://127.0.0.1:8080`

### 3. 登录

- 用户名：`admin`
- 密码：`admin123`

## 📁 项目结构

```
frontend/
├── index.html          # 主页面（功能导航）
├── login.html          # 登录页面
├── pan.html            # 八字排盘页面
├── dayun.html          # 大运分析页面
├── liunian.html        # 流年分析页面
├── yigua.html          # 一事一卦页面
├── config.js           # API 配置
├── css/
│   └── style.css       # 样式文件
├── js/
│   ├── api.js          # API 调用封装
│   ├── auth.js         # 认证相关
│   ├── pan.js          # 排盘逻辑
│   ├── dayun.js        # 大运逻辑
│   ├── liunian.js      # 流年逻辑
│   └── yigua.js        # 一事一卦逻辑
└── README.md           # 本文件
```

## 🎯 功能说明

### 1. 登录功能
- 使用 JWT Token 认证
- Token 存储在 localStorage
- 自动跳转到登录页面（如果未登录）

### 2. 八字排盘
- 输入出生日期、时间、性别
- 显示四柱信息（年柱、月柱、日柱、时柱）
- 显示五行统计
- 调用接口：`POST /api/v1/bazi/pan/display`

### 3. 大运分析
- 输入出生信息
- 显示当前大运
- 显示大运序列
- 显示起运和交运信息
- 调用接口：`POST /api/v1/bazi/dayun/display`

### 4. 流年分析
- 输入出生信息
- 可指定年份范围
- 显示当前流年
- 显示流年序列（带年龄）
- 调用接口：`POST /api/v1/bazi/liunian/display`

### 5. 一事一卦
- 输入要占卜的问题
- 显示卦象信息
- 显示卦辞和解读
- 调用接口：`POST /api/v1/bazi/yigua/divinate`

## 🔧 配置说明

### 修改 API 地址

编辑 `config.js` 文件：

```javascript
const API_CONFIG = {
    baseURL: 'http://127.0.0.1:8001/api/v1',  // 修改为你的后端地址
    timeout: 30000
};
```

### 修改登录信息

登录信息在后端配置，默认：
- 用户名：`admin`
- 密码：`admin123`

可以通过环境变量修改（后端）。

## 📝 使用示例

### 测试排盘功能

1. 打开 `pan.html`
2. 输入出生信息：
   - 出生日期：1990-05-15
   - 出生时间：14:30
   - 性别：男
3. 点击"查询排盘"
4. 查看结果

### 测试大运功能

1. 打开 `dayun.html`
2. 输入出生信息
3. 可选：输入当前时间
4. 点击"查询大运"
5. 查看大运序列

### 测试流年功能

1. 打开 `liunian.html`
2. 输入出生信息
3. 可选：指定年份范围（如 2020-2030）
4. 点击"查询流年"
5. 查看流年序列

### 测试一事一卦

1. 打开 `yigua.html`
2. 输入要占卜的问题（如"我这次投资能成功吗？"）
3. 点击"开始占卜"
4. 查看卦象和解读

## ⚠️ 注意事项

1. **CORS 问题**：如果直接打开 HTML 文件，可能会遇到 CORS 问题。建议使用本地服务器。

2. **后端服务**：确保后端服务已启动，并且运行在 `http://127.0.0.1:8001`。

3. **Token 过期**：如果 Token 过期，需要重新登录。

4. **网络错误**：如果遇到网络错误，检查：
   - 后端服务是否运行
   - API 地址是否正确
   - 网络连接是否正常

## 🐛 常见问题

### 问题 1：登录后跳转失败

**原因：** 可能是 Token 未正确保存。

**解决：** 检查浏览器控制台，查看是否有错误信息。

### 问题 2：API 调用失败

**原因：** 可能是 CORS 问题或后端服务未启动。

**解决：**
1. 使用本地服务器打开页面
2. 检查后端服务是否运行
3. 检查 API 地址是否正确

### 问题 3：显示空白页面

**原因：** 可能是 JavaScript 错误。

**解决：** 打开浏览器开发者工具（F12），查看 Console 中的错误信息。

## 📚 技术栈

- **HTML5**：页面结构
- **CSS3**：样式设计（响应式布局）
- **JavaScript (ES6+)**：业务逻辑
- **Fetch API**：HTTP 请求
- **LocalStorage**：Token 存储

## 🔄 前后端分离说明

- **前端**：纯静态文件，不依赖后端框架
- **后端**：FastAPI 服务，提供 REST API
- **通信**：通过 HTTP REST API 进行通信
- **认证**：使用 JWT Token

## 📞 联系支持

如有问题，请查看：
- 后端 API 文档：`http://127.0.0.1:8001/docs`
- 后端日志：`logs/web_app_8001.log`

---

**版本：** v1.0  
**最后更新：** 2025-01-XX

