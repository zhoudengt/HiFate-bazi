# HiFate-bazi Docker Compose 镜像配置
# 标准 CI/CD 流程：使用从 GitHub Container Registry 拉取的镜像
# 使用方式：DOCKER_IMAGE=ghcr.io/owner/repo/hifate-bazi:master docker compose -f docker-compose.yml -f docker-compose.prod.yml -f docker-compose.image.yml up -d
# 功能：使用预构建的镜像而不是本地构建（标准流程）

version: '3.8'

services:
  # 主服务 - 使用镜像
  web:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null  # 禁用构建，只使用镜像

  # 计算微服务（bazi-core + bazi-fortune + bazi-analyzer + fortune-analysis）
  bazi-compute:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null

  # 规则引擎微服务（bazi-rule + fortune-rule）
  rule-engine:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null

  # 支付服务 - 使用镜像
  payment-service:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null

  # 意图识别服务 - 使用镜像
  intent-service:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null

  # 提示优化服务 - 使用镜像
  prompt-optimizer:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null

  # 办公桌风水服务 - 使用镜像
  desk-fengshui:
    image: ${DOCKER_IMAGE:-ghcr.io/owner/repo/hifate-bazi:latest}
    build: null
